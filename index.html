<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="InvestHub — Pre-IPO Investment Offerings Platform">
    <meta name="theme-color" content="#1a1a1a">
    <title>InvestHub — Pre-IPO Investment Offerings</title>
    
    <!-- Favicon SVG -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='6' fill='%23000'/><path d='M8 16L16 8L24 16M16 8V24' stroke='%23fff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/></svg>">
    
    <!-- Tailwind CSS (must be script, not link) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React 18 Development (needed for UMD globals) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <!-- ReactDOM 18 Development -->
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
    </style>
</head>
<body class="bg-white text-gray-900">
    <div id="root"><div style="color:white;padding:40px;">Loading...</div></div>
    <script>window.onerror = function(msg, url, line, col, err) { document.getElementById("root").innerHTML = '<div style="color:red;padding:40px;background:white;"><h2>JS Error:</h2><pre>' + msg + '\nLine: ' + line + '\nCol: ' + col + '</pre></div>'; };</script>
    <script type="text/babel">
const { useState, useMemo } = React;

// ─── Inline SVG Icon Components (replacing Lucide React) ─────────────────
const Search = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <circle cx="11" cy="11" r="8"></circle>
    <path d="m21 21-4.35-4.35"></path>
  </svg>
);

const TrendingUp = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="23 6 13.5 15.5 8.5 10.5 1 17"></polyline>
    <polyline points="17 6 23 6 23 12"></polyline>
  </svg>
);

const TrendingDown = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="23 18 13.5 8.5 8.5 13.5 1 7"></polyline>
    <polyline points="17 18 23 18 23 12"></polyline>
  </svg>
);

const ArrowLeft = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="19" y1="12" x2="5" y2="12"></line>
    <polyline points="12 19 5 12 12 5"></polyline>
  </svg>
);

const ArrowRight = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="5" y1="12" x2="19" y2="12"></line>
    <polyline points="12 5 19 12 12 19"></polyline>
  </svg>
);

const X = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>
);

const DollarSign = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <line x1="12" y1="1" x2="12" y2="23"></line>
    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
  </svg>
);

const Building2 = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M3 21v-4a6 6 0 0 1 6-6h6a6 6 0 0 1 6 6v4"></path>
    <rect x="3" y="21" width="18" height="3"></rect>
    <path d="M9 3h1"></path>
    <path d="M14 3h1"></path>
    <path d="M9 9h1"></path>
    <path d="M14 9h1"></path>
    <path d="M9 15h1"></path>
    <path d="M14 15h1"></path>
  </svg>
);

const BarChart3 = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M3 3v18h18"></path>
    <rect x="7" y="16" width="3" height="7"></rect>
    <rect x="15" y="11" width="3" height="12"></rect>
    <rect x="11" y="6" width="3" height="17"></rect>
  </svg>
);

const Shield = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
  </svg>
);

const ChevronRight = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
);

const ExternalLink = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
    <polyline points="15 3 21 3 21 9"></polyline>
    <line x1="10" y1="14" x2="21" y2="3"></line>
  </svg>
);

const User = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
    <circle cx="12" cy="7" r="4"></circle>
  </svg>
);

const Mail = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <rect x="2" y="4" width="20" height="16" rx="2"></rect>
    <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
  </svg>
);

const Lock = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
  </svg>
);

const Eye = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
    <circle cx="12" cy="12" r="3"></circle>
  </svg>
);

const EyeOff = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
    <line x1="1" y1="1" x2="23" y2="23"></line>
  </svg>
);

const Check = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <polyline points="20 6 9 17 4 12"></polyline>
  </svg>
);

const Upload = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
    <polyline points="17 8 12 3 7 8"></polyline>
    <line x1="12" y1="3" x2="12" y2="15"></line>
  </svg>
);

const Briefcase = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
    <path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"></path>
  </svg>
);

const Target = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <circle cx="12" cy="12" r="1"></circle>
    <circle cx="12" cy="12" r="5"></circle>
    <circle cx="12" cy="12" r="9"></circle>
  </svg>
);

const AlertTriangle = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3.04h16.94a2 2 0 0 0 1.71-3.04l-8.47-14.14a2 2 0 0 0-3.42 0z"></path>
    <line x1="12" y1="9" x2="12" y2="13"></line>
    <line x1="12" y1="17" x2="12.01" y2="17"></line>
  </svg>
);

const LogOut = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
    <polyline points="16 17 21 12 16 7"></polyline>
    <line x1="21" y1="12" x2="9" y2="12"></line>
  </svg>
);

const FileText = ({ size = 24, className = "" }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
    <polyline points="14 2 14 8 20 8"></polyline>
    <line x1="12" y1="13" x2="12" y2="17"></line>
    <line x1="9" y1="15" x2="15" y2="15"></line>
  </svg>
);

// ─── Company Logo SVGs (inline, always load) ─────────────────
const companyLogoSVGs = {
  anthropic: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#D4A27F"/><path d="M20 8L28 28H24L22 23H18L16 28H12L20 8ZM20 14L17.5 21H22.5L20 14Z" fill="white"/></svg>`,
  spacex: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#005288"/><path d="M10 11H15L20 18.5L25 11H30L23 21L30 31H25L20 23.5L15 31H10L17 21L10 11Z" fill="white"/></svg>`,
  stripe: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#635BFF"/><path d="M18.5 15.5C18.5 14.5 19.3 14 20.5 14C22.2 14 24.2 14.7 25.5 15.5V10.8C24.1 10.3 22.7 10 20.5 10C16.4 10 13.5 12.4 13.5 16C13.5 21.5 21 20.2 21 22.8C21 23.9 20 24.5 18.7 24.5C16.8 24.5 14.6 23.6 13.2 22.6V27.4C14.8 28.2 16.4 28.5 18.7 28.5C22.9 28.5 26 26.2 26 22.5C26 16.5 18.5 18 18.5 15.5Z" fill="white"/></svg>`,
  databricks: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#FF3621"/><path d="M20 8L30 14V20L20 26L10 20V14L20 8Z" fill="white" opacity="0.9"/><path d="M20 20L30 26V28L20 34L10 28V26L20 20Z" fill="white" opacity="0.6"/></svg>`,
  canva: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#00C4CC"/><circle cx="20" cy="20" r="10" fill="white" opacity="0.9"/><circle cx="20" cy="20" r="5" fill="#00C4CC"/><circle cx="20" cy="12" r="2" fill="#7D2AE8"/><circle cx="26" cy="16" r="2" fill="#00C4CC"/><circle cx="26" cy="24" r="2" fill="#FFD966"/><circle cx="14" cy="16" r="2" fill="#FF6384"/></svg>`,
  discord: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#5865F2"/><path d="M27 13.5C25.7 12.9 24.3 12.5 22.8 12.3C22.6 12.7 22.4 13.1 22.2 13.5C20.7 13.3 19.3 13.3 17.8 13.5C17.6 13.1 17.4 12.7 17.2 12.3C15.7 12.5 14.3 12.9 13 13.5C10.5 17.4 9.8 21.2 10.2 24.9C11.8 26.1 13.4 26.8 14.9 27.3C15.3 26.7 15.7 26.1 16 25.5C15.4 25.3 14.8 25 14.3 24.6C14.4 24.5 14.6 24.4 14.7 24.3C17.9 25.8 22.1 25.8 25.3 24.3C25.4 24.4 25.6 24.5 25.7 24.6C25.2 25 24.6 25.3 24 25.5C24.3 26.1 24.7 26.7 25.1 27.3C26.6 26.8 28.2 26.1 29.8 24.9C30.3 20.6 29.1 16.8 27 13.5ZM16.4 23C15.5 23 14.7 22.1 14.7 21C14.7 19.9 15.4 19 16.4 19C17.3 19 18.1 19.9 18.1 21C18.1 22.1 17.3 23 16.4 23ZM23.6 23C22.7 23 21.9 22.1 21.9 21C21.9 19.9 22.6 19 23.6 19C24.5 19 25.3 19.9 25.3 21C25.3 22.1 24.5 23 23.6 23Z" fill="white"/></svg>`,
  anduril: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#1A1A2E"/><path d="M20 8L24 16L32 18L26 24L27 32L20 28L13 32L14 24L8 18L16 16L20 8Z" fill="white" opacity="0.9"/></svg>`,
  revolut: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#0075EB"/><path d="M14 10H22C25.3 10 28 12.7 28 16C28 18.5 26.5 20.6 24.3 21.5L29 30H24L19.7 22H18V30H14V10ZM18 18H22C23.1 18 24 17.1 24 16C24 14.9 23.1 14 22 14H18V18Z" fill="white"/></svg>`,
  "epic-games": `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#2F2D2E"/><path d="M12 10H28V14H16V18H26V22H16V26H28V30H12V10Z" fill="white"/></svg>`,
  plaid: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#111111"/><rect x="10" y="10" width="6" height="6" rx="1" fill="white" opacity="0.9"/><rect x="17" y="10" width="6" height="6" rx="1" fill="white" opacity="0.6"/><rect x="24" y="10" width="6" height="6" rx="1" fill="white" opacity="0.3"/><rect x="10" y="17" width="6" height="6" rx="1" fill="white" opacity="0.6"/><rect x="17" y="17" width="6" height="6" rx="1" fill="white" opacity="0.9"/><rect x="24" y="17" width="6" height="6" rx="1" fill="white" opacity="0.6"/><rect x="10" y="24" width="6" height="6" rx="1" fill="white" opacity="0.3"/><rect x="17" y="24" width="6" height="6" rx="1" fill="white" opacity="0.6"/><rect x="24" y="24" width="6" height="6" rx="1" fill="white" opacity="0.9"/></svg>`,
  kyuchyus: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#FFD700"/><path d="M20 8L26 18L28 28H12L14 18L20 8Z" fill="white" opacity="0.9"/><circle cx="20" cy="12" r="3" fill="white" opacity="0.7"/></svg>`,
  "sukhoi-log": `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#B8860B"/><path d="M20 8L28 18L30 28H10L12 18L20 8Z" fill="white" opacity="0.9"/><rect x="18" y="20" width="4" height="8" fill="white" opacity="0.6"/></svg>`,
  baimskaya: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#B87333"/><path d="M10 14L14 10L18 14L22 10L26 14L30 10V28H10V14Z" fill="white" opacity="0.9"/><path d="M14 20L22 20" stroke="white" stroke-width="2" opacity="0.7"/></svg>`,
  udokan: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#8B4513"/><rect x="12" y="12" width="6" height="14" fill="white" opacity="0.9"/><rect x="20" y="8" width="6" height="18" fill="white" opacity="0.8"/><rect x="28" y="14" width="4" height="12" fill="white" opacity="0.7"/></svg>`,
  tomtor: `<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="40" height="40" rx="8" fill="#6A0DAD"/><path d="M20 8L24 16L20 24L16 16L20 8Z" fill="white" opacity="0.9"/><circle cx="20" cy="20" r="2" fill="white" opacity="0.8"/><path d="M20 8L26 20L20 32L14 20L20 8Z" fill="none" stroke="white" stroke-width="1" opacity="0.4"/></svg>`,
};

function CompanyLogo({ company, size = 48, className = "" }) {
  const svg = companyLogoSVGs[company.id];
  if (svg) {
    return <div className={className} style={{width: size, height: size, flexShrink: 0}} dangerouslySetInnerHTML={{__html: svg}} />;
  }
  return (
    <div className={`rounded-xl flex items-center justify-center font-bold text-white ${className}`} style={{width: size, height: size, flexShrink: 0, background: company.color || '#6366f1', fontSize: size * 0.4}}>
      {company.name[0]}
    </div>
  );
}

// ─── Demo Data ────────────────────────────────────────────────
const companies = [
  {
    id: "kyuchyus", name: "Кючус (Kyuchyus)", ticker: "TKYCH", tagline: "Крупное золоторудное месторождение в Якутии, запасы 175 тонн", category: "Tokens",
    color: "#FFD700", founded: "2020", hq: "Yakutia, Russia", founders: "Polyus Gold", sector: "Gold Mining", highlights: ["Запасы золота 175 тонн", "Категории C1+C2", "Расположено в Якутии (Саха)", "Токенизированный доступ к инвестициям"],
    markPrice: 12.50, annualChange: 34, valuation: "$2.8B", valuationNum: 2.8e9, fundsRaised: "$450M", lastRound: "$120M", roundDate: "2024",
    about: `Кючус — одно из крупнейших неразработанных золоторудных месторождений России, расположенное в Республике Саха (Якутия).\n\nМесторождение содержит около 175 тонн золота категорий запасов C1+C2. Токенизированные инвестиции обеспечивают долевой доступ к этому стратегическому горнодобывающему активу.`,
    opportunities: "Цена золота на историческом максимуме. Стратегическая важность внутренней золотодобычи. Растущий спрос на альтернативный инвестиционный доступ к горнодобывающим активам через токенизацию.",
    financials: "Оценочная стоимость запасов в недрах превышает $12 млрд при текущих ценах на золото. Держатели токенов получают пропорциональный доступ к доходам от добычи после начала промышленной эксплуатации.",
    risks: "Удалённое арктическое расположение увеличивает операционные расходы. Регуляторные риски в российском горнодобывающем секторе. Доходы отсутствуют на стадии до начала добычи. Ликвидность токенов может быть ограничена."
  },
  {
    id: "sukhoi-log", name: "Сухой Лог (Sukhoi Log)", ticker: "TSLOG", tagline: "Крупнейшее в мире неразработанное золоторудное месторождение, запасы 1500+ тонн", category: "Tokens",
    color: "#B8860B", founded: "2019", hq: "Irkutsk Oblast, Russia", founders: "Polyus Gold", sector: "Gold Mining", highlights: ["Запасы золота 1500+ тонн", "Крупнейшее неразработанное в мире", "Потенциал открытой добычи", "Стратегический национальный актив"],
    markPrice: 28.00, annualChange: 52, valuation: "$8.5B", valuationNum: 8.5e9, fundsRaised: "$1.2B", lastRound: "$350M", roundDate: "2024",
    about: `Сухой Лог — крупнейшее в мире неразработанное золоторудное месторождение, расположенное в Иркутской области России.\n\nС подтверждёнными запасами более 1500 тонн золота это один из наиболее значимых минеральных активов в мире. Токенизированный доступ обеспечивает долевые инвестиции в это мегаместорождение.`,
    opportunities: "Непревзойдённый масштаб как крупнейшего неразработанного золоторудного месторождения в мире. Потенциал открытой добычи с низкой себестоимостью. Глобальный спрос на золото обусловлен покупками центробанков и геополитической неопределённостью.",
    financials: "Оценочная стоимость запасов в недрах превышает $100 млрд при текущих ценах на золото. Полюс Золото, крупнейший золотодобытчик России, владеет лицензией. Потенциальная добыча — 50+ тонн ежегодно.",
    risks: "Требуются масштабные капитальные вложения на освоение. Экологические и разрешительные сложности. Геополитические риски, влияющие на международные инвестиционные потоки. Длительные сроки разработки."
  },
  {
    id: "baimskaya", name: "Баимская (Baimskaya)", ticker: "TBAIM", tagline: "Крупное медно-золотое порфировое месторождение на Чукотке", category: "Tokens",
    color: "#B87333", founded: "2021", hq: "Chukotka, Russia", founders: "Trianon / KAZ Minerals", sector: "Copper & Gold Mining", highlights: ["9.5 Мт медного эквивалента", "Крупная медно-золотая порфировая система", "Ожидаемый срок эксплуатации 25+ лет", "Критический минерал для энергоперехода"],
    markPrice: 8.75, annualChange: 28, valuation: "$4.2B", valuationNum: 4.2e9, fundsRaised: "$800M", lastRound: "$200M", roundDate: "2024",
    about: `Баимская — одно из крупнейших в мире неразработанных медно-золотых порфировых месторождений, расположенное в Чукотском автономном округе России.\n\nМесторождение содержит около 9,5 млн тонн медного эквивалента. Токенизированные инвестиции дают доступ к критическим минералам, необходимым для глобального энергоперехода.`,
    opportunities: "Спрос на медь резко растёт из-за электрификации и возобновляемой энергетики. Глобально ограничено число новых крупных медных открытий. Прогнозируемый срок эксплуатации 25+ лет обеспечивает долгосрочную стоимость.",
    financials: "Общие инвестиции в проект оцениваются в $7-8 млрд. Ожидаемое годовое производство — 300 000+ тонн медного концентрата. Держатели токенов получают пропорциональный доступ к экономике производства.",
    risks: "Экстремальные арктические условия увеличивают затраты на строительство и эксплуатацию. Значительные требования к инфраструктуре. Длительные сроки строительства. Волатильность валют и цен на сырьё."
  },
  {
    id: "udokan", name: "Удокан (Udokan)", ticker: "TUDKN", tagline: "Одно из крупнейших медных месторождений мира, добыча начата", category: "Tokens",
    color: "#8B4513", founded: "2020", hq: "Zabaikalsky Krai, Russia", founders: "USM Holdings", sector: "Copper Mining", highlights: ["Запасы меди 26,7 Мт", "Добыча начата в 2023", "Топ-3 мировых медных месторождений", "Целевой объём 135 000 тонн катодной меди в год"],
    markPrice: 15.30, annualChange: 45, valuation: "$5.6B", valuationNum: 5.6e9, fundsRaised: "$2.9B", lastRound: "$500M", roundDate: "2023",
    about: `Удокан — одно из крупнейших медных месторождений мира, расположенное в Забайкальском крае России. Месторождение содержит около 26,7 млн тонн меди.\n\nДобыча начата в 2023 году компанией Удоканская медь (USM Holdings). Токенизированные инвестиции обеспечивают прямой доступ к этому мировому добывающему медному активу.`,
    opportunities: "Достигнута фаза добычи — генерация выручки началась. Медь критически важна для электромобилей, ВИЭ и электрификации. Глобальный дефицит меди прогнозируется до 2030 года.",
    financials: "Первая очередь рассчитана на 135 000 тонн катодной меди в год. Общие инвестиции превышают $2,9 млрд. Наращивание выручки идёт, первая катодная медь произведена в 2023.",
    risks: "Риски выхода на проектную мощность. Удалённое расположение в Восточной Сибири. Капиталоёмкое расширение второй очереди. Волатильность цен на медь влияет на доходность."
  },
  {
    id: "tomtor", name: "Томтор (Tomtor)", ticker: "TTMTR", tagline: "Месторождение редкоземельных элементов и ниобия мирового класса", category: "Tokens",
    color: "#6A0DAD", founded: "2021", hq: "Yakutia, Russia", founders: "TriArk Mining", sector: "Rare Earth Elements", highlights: ["Одно из богатейших РЗЭ-месторождений мира", "Критические минералы для хай-тека", "Ниобий и редкие земли", "Стратегический геополитический актив"],
    markPrice: 5.40, annualChange: 18, valuation: "$1.8B", valuationNum: 1.8e9, fundsRaised: "$280M", lastRound: "$75M", roundDate: "2024",
    about: `Томтор — одно из крупнейших и богатейших месторождений редкоземельных элементов (РЗЭ) и ниобия в мире, расположенное в Якутии, Россия.\n\nМесторождение содержит исключительно высокие концентрации РЗЭ, критически важных для электроники, обороны и зелёной энергетики. Токенизированные инвестиции открывают доступ к этому стратегическому минеральному ресурсу.`,
    opportunities: "Мировой рынок РЗЭ доминирует Китай — спрос на диверсификацию высок. Критические минералы для электромобилей, ветрогенераторов и обороны. Растущий фокус Запада на безопасности цепочек поставок.",
    financials: "Оценочная стоимость месторождения превышает $15 млрд по текущим ценам на РЗЭ. Финансирование разработки продолжается при государственной поддержке. Токен даёт доступ на ранней стадии к производству РЗЭ.",
    risks: "Ранняя стадия разработки без текущих доходов от добычи. Требуется сложная металлургическая переработка. Ограниченный рынок РЗЭ за пределами Китая. Удалённое расположение увеличивает логистические затраты."
  },
  {
    id: "anthropic", name: "Anthropic", ticker: "UTANTH", tagline: "AI safety leader building the future of intelligence", category: "Pre-IPO",
    color: "#D4A27F", founded: "2021", hq: "San Francisco, CA", founders: "Dario Amodei, Daniela Amodei", sector: "Artificial Intelligence", highlights: ["10x revenue growth in 18 months", "120M+ monthly active users", "$5B+ cash reserves", "Strategic partnerships with Amazon & Google"],
    markPrice: 156.80, annualChange: 478, valuation: "$61.5B", valuationNum: 61.5e9, fundsRaised: "$13.70B", lastRound: "$2.00B", roundDate: "2025",
    about: `Anthropic is an AI safety company building reliable, interpretable, and steerable AI systems. Founded in 2021 by Dario and Daniela Amodei — former VP of Research and VP of Safety at OpenAI — along with a team of leading AI researchers, Anthropic has rapidly emerged as one of the most important companies in the artificial intelligence industry.\n\nThe company's flagship product, Claude, is a family of large language models known for their helpfulness, harmlessness, and honesty. Claude is used by millions of consumers and enterprises worldwide, powering everything from coding assistance and research analysis to customer service automation and creative workflows. Anthropic's proprietary Constitutional AI (CAI) training methodology and Responsible Scaling Policy set the standard for safe AI development.\n\nAnthropic operates a massive compute infrastructure with custom training clusters, and has strategic partnerships with Amazon Web Services (AWS) and Google Cloud. The company employs 1,500+ researchers and engineers, many considered among the top AI talent globally.`,
    opportunities: `The global AI market is projected to reach $1.8T by 2030, growing at 37% CAGR. Anthropic is uniquely positioned at the intersection of capability and safety — the two most critical dimensions of AI development.\n\nEnterprise adoption is accelerating: Claude is deployed across Fortune 500 companies in finance, healthcare, legal, and technology sectors. The Claude API processes billions of tokens daily with enterprise revenue growing 8x year-over-year. Key growth vectors include Claude for Enterprise (team collaboration), Claude Code (developer tools), the Anthropic API platform, and strategic OEM partnerships.\n\nAnthropic's $4B partnership with Amazon and $2B investment from Google provide massive distribution advantages through AWS Bedrock and Google Cloud Vertex AI. Government contracts for AI safety consulting and secure deployments represent an emerging high-margin revenue stream.`,
    financials: `Anthropic's annualized revenue run rate exceeded $2B in early 2025, up from $200M in 2023 — a 10x increase in under 18 months. The company is on track to reach $4B+ ARR by end of 2025.\n\nGross margins are estimated at 50-55%, with significant operating leverage as the model training costs amortize across a rapidly growing user base. Revenue mix is shifting toward enterprise (65%) and API (25%), with consumer subscriptions at 10%.\n\nTotal funding raised: $13.7B across multiple rounds. The most recent round in early 2025 valued the company at $61.5B, led by Lightspeed Venture Partners with participation from Salesforce Ventures, Menlo Ventures, and existing investors. Strategic investors include Amazon ($4B commitment), Google ($2B), and Spark Capital. The company maintains $5B+ in cash reserves.`,
    risks: `Intense competition from OpenAI, Google DeepMind, Meta AI, and emerging Chinese AI labs (DeepSeek, Zhipu). The AI foundation model market may commoditize, pressuring margins. Regulatory uncertainty — pending AI legislation in the EU, US, and China could impose compliance costs or restrict capabilities.\n\nHigh capital expenditure requirements: training frontier models costs $500M-$1B+ per run, requiring continuous fundraising or path to profitability. Talent retention is critical as top AI researchers are heavily recruited. Dependence on cloud providers (AWS, Google) for compute creates strategic vulnerability. Low liquidity typical of pre-IPO investments.`,
    analytics: {
      revenueHistory: [
        { period: "Q1 2023", value: 40 }, { period: "Q2 2023", value: 75 }, { period: "Q3 2023", value: 150 }, { period: "Q4 2023", value: 280 },
        { period: "Q1 2024", value: 450 }, { period: "Q2 2024", value: 680 }, { period: "Q3 2024", value: 960 }, { period: "Q4 2024", value: 1400 },
        { period: "Q1 2025", value: 2100 },
      ],
      valuationHistory: [
        { round: "Series A (2021)", value: 1, investors: "Jaan Tallinn, Dustin Moskovitz" },
        { round: "Series B (2022)", value: 4.1, investors: "Spark Capital, Google" },
        { round: "Series C (2023)", value: 18.4, investors: "Google, Spark Capital, Salesforce" },
        { round: "Series D (2023)", value: 25, investors: "Amazon ($4B commitment)" },
        { round: "Series E (2024)", value: 40, investors: "Menlo Ventures, Amazon, Google" },
        { round: "Series F (2025)", value: 61.5, investors: "Lightspeed, Salesforce Ventures" },
      ],
      keyMetrics: [
        { label: "API Tokens/Day", value: "45B+", change: "+320% YoY", positive: true },
        { label: "Enterprise Clients", value: "12,500+", change: "+650% YoY", positive: true },
        { label: "Gross Margin", value: "53%", change: "+8pp YoY", positive: true },
        { label: "Net Revenue Retention", value: "185%", change: "+40pp YoY", positive: true },
        { label: "Employees", value: "1,500+", change: "+110% YoY", positive: true },
        { label: "Monthly Active Users", value: "120M+", change: "+400% YoY", positive: true },
      ],
      marketShare: [
        { name: "OpenAI", share: 34 },
        { name: "Anthropic", share: 22 },
        { name: "Google", share: 18 },
        { name: "Meta", share: 12 },
        { name: "Others", share: 14 },
      ],
      competitiveEdge: [
        { area: "Safety & Alignment", score: 96, avg: 62 },
        { area: "Enterprise Adoption", score: 88, avg: 70 },
        { area: "Research Output", score: 91, avg: 68 },
        { area: "Developer Experience", score: 85, avg: 72 },
        { area: "Model Capability", score: 93, avg: 78 },
      ]
    }
  },
  {
    id: "spacex", name: "SpaceX", ticker: "UTSPX", tagline: "Revolutionary in the space industry", category: "Pre-IPO",
    color: "#005288", founded: "2002", hq: "Hawthorne, CA", founders: "Elon Musk", sector: "Aerospace & Defense", highlights: ["250+ successful missions", "5,000+ Starlink satellites", "$127B valuation", "NASA Artemis lunar lander contract"],
    markPrice: 61, annualChange: 326, valuation: "$127B", valuationNum: 127e9, fundsRaised: "$8.60B", lastRound: "$1.70B", roundDate: "2022",
    about: `SpaceX designs, manufactures and launches advanced rockets and spacecraft. Founded in 2002 by Elon Musk with the goal of making humanity multiplanetary, SpaceX has pioneered reusable rocket technology and completed over 250 successful missions.\n\nThe company operates Starlink, a satellite internet constellation with 5,000+ satellites providing broadband coverage in 60+ countries. SpaceX is also developing Starship, a fully reusable super-heavy launch vehicle designed for missions to the Moon and Mars.`,
    opportunities: "Moon Markets Analysis forecasts 140+ Moon Missions over the next decade generating $42.3B in revenue. NASA awarded SpaceX the contract to build the Artemis lunar lander. Starlink is projected to reach $10B+ annual recurring revenue by 2025.",
    financials: "SpaceX's last publicly reported revenue exceeded $4.6B. Starlink alone generates $2B+ in recurring revenue. The company has raised a total of $9.5B across multiple funding rounds. Key investors include NASA, Baillie Gifford, Bank of America, Fidelity, Google, and Founders Fund.",
    risks: "Competition from Amazon's Project Kuiper satellite network. Regulatory challenges with Starship launches. Revenue concentration in government contracts. Low liquidity typical of pre-IPO investments — early exits may result in significant price differences."
  },
  {
    id: "stripe", name: "Stripe", ticker: "UTSTRP", tagline: "Global payments infrastructure platform", category: "Pre-IPO",
    color: "#635BFF", founded: "2010", hq: "San Francisco, CA", founders: "Patrick & John Collison", sector: "Financial Technology", highlights: ["$14B+ annual revenue", "Profitable since 2023", "46+ countries", "Hundreds of billions processed annually"],
    markPrice: 27.50, annualChange: 48, valuation: "$65B", valuationNum: 65e9, fundsRaised: "$8.70B", lastRound: "$6.50B", roundDate: "2023",
    about: `Stripe is a financial infrastructure platform for the internet. Millions of companies — from startups to Fortune 500s — use Stripe to accept payments, grow their revenue, and accelerate new business opportunities.\n\nFounded in 2010 by Patrick and John Collison, Stripe processes hundreds of billions of dollars annually and operates in 46+ countries.`,
    opportunities: "Global digital payments market projected to reach $14.8T by 2027. Stripe's expansion into banking-as-a-service, lending, and corporate cards opens massive new revenue streams.",
    financials: "Stripe achieved profitability in 2023. Revenue exceeded $14B in 2023 with strong gross margins. The company raised $6.5B at a $50B valuation in March 2023.",
    risks: "Intense competition from PayPal, Adyen, and Square. Regulatory complexity across multiple jurisdictions. Potential margin pressure from interchange fee regulations."
  },
  {
    id: "databricks", name: "Databricks", ticker: "UTDBRK", tagline: "Unified analytics and AI platform", category: "Pre-IPO",
    color: "#FF3621", founded: "2013", hq: "San Francisco, CA", founders: "Ali Ghodsi, et al.", sector: "Data & Analytics", highlights: ["$1.6B ARR, 50%+ YoY growth", "10,000+ enterprise customers", "Created Apache Spark", "Lakehouse architecture standard"],
    markPrice: 45.20, annualChange: 72, valuation: "$43B", valuationNum: 43e9, fundsRaised: "$4.20B", lastRound: "$500M", roundDate: "2023",
    about: `Databricks provides a unified set of tools for building, deploying, sharing, and maintaining enterprise-grade data, analytics, and AI solutions at scale.\n\nFounded in 2013 by the original creators of Apache Spark, Databricks serves 10,000+ organizations worldwide.`,
    opportunities: "Enterprise AI adoption is accelerating. The data analytics market is expected to exceed $100B by 2026.",
    financials: "Databricks reached $1.6B in annualized revenue in 2023, growing 50%+ year-over-year. Investors include Andreessen Horowitz, T. Rowe Price, and Morgan Stanley.",
    risks: "Competition from Snowflake, AWS, Google BigQuery, and Microsoft Fabric. Customer concentration risk. High burn rate despite strong revenue growth."
  },
  {
    id: "canva", name: "Canva", ticker: "UTCNVA", tagline: "Visual communication and design platform", category: "Pre-IPO",
    color: "#00C4CC", founded: "2013", hq: "Sydney, Australia", founders: "Melanie Perkins", sector: "Design & Collaboration", highlights: ["150M+ monthly active users", "Profitable since 2022", "190 countries", "$2.1B annual revenue"],
    markPrice: 31.80, annualChange: 22, valuation: "$26B", valuationNum: 26e9, fundsRaised: "$572M", lastRound: "$200M", roundDate: "2021",
    about: `Canva is an online design and visual communication platform with a mission to empower everyone in the world to design.\n\nFounded in 2013 in Sydney, Australia, Canva now has 150+ million monthly active users across 190 countries.`,
    opportunities: "Visual communication market growing rapidly with remote work. Enterprise tier showing strong adoption. AI features driving engagement.",
    financials: "Canva reached $2.1B in annualized revenue in 2023. The company has been profitable since 2022. Investors include Sequoia, Blackbird Ventures, and T. Rowe Price.",
    risks: "Competition from Adobe (Express), Microsoft (Designer), and Figma. Free-to-paid conversion rates. Market saturation in consumer segment."
  },
  {
    id: "discord", name: "Discord", ticker: "UTDCRD", tagline: "Communication platform for communities", category: "Pre-IPO",
    color: "#5865F2", founded: "2015", hq: "San Francisco, CA", founders: "Jason Citron", sector: "Communication", highlights: ["200M+ monthly active users", "$600M revenue", "App marketplace ecosystem", "Expanding beyond gaming"],
    markPrice: 18.40, annualChange: -5, valuation: "$15B", valuationNum: 15e9, fundsRaised: "$995M", lastRound: "$500M", roundDate: "2021",
    about: `Discord is a voice, video, and text communication platform originally built for gamers that has expanded into a general-purpose community hub.\n\nFounded in 2015, Discord has grown to 200+ million monthly active users.`,
    opportunities: "Community platform market is growing rapidly. Enterprise and education use cases expanding. App marketplace creating platform lock-in.",
    financials: "Discord generated approximately $600M in revenue in 2023. The company has not yet reached profitability. Last valued at $15B in 2021.",
    risks: "Profitability concerns with high infrastructure costs. Competition from Slack, Teams, and emerging platforms. Content moderation challenges."
  },
  {
    id: "anduril", name: "Anduril Industries", ticker: "UTANDL", tagline: "AI-powered defense technology", category: "Pre-IPO",
    color: "#1A1A2E", founded: "2017", hq: "Costa Mesa, CA", founders: "Palmer Luckey", sector: "Defense Technology", highlights: ["$500M+ revenue", "Lattice AI platform", "Counter-drone leader", "Founded by Oculus VR creator"],
    markPrice: 52.60, annualChange: 115, valuation: "$14B", valuationNum: 14e9, fundsRaised: "$2.80B", lastRound: "$1.50B", roundDate: "2023",
    about: `Anduril Industries is a defense technology company that builds autonomous systems and AI-powered platforms for national security.\n\nFounded in 2017 by Palmer Luckey (Oculus VR founder), Anduril develops autonomous drones, counter-drone systems, and surveillance towers.`,
    opportunities: "U.S. defense budget exceeding $800B annually with increasing focus on autonomous systems. Counter-drone market expected to reach $7.6B by 2027.",
    financials: "Anduril's revenue is estimated at $500M+ in 2023. The company raised $1.5B at a $14B valuation in 2023.",
    risks: "Government contract dependency and procurement cycles. Political sensitivity around autonomous weapons. Competition from Lockheed, Raytheon."
  },
  {
    id: "revolut", name: "Revolut", ticker: "UTRVLT", tagline: "Global financial super-app", category: "Pre-IPO",
    color: "#0075EB", founded: "2015", hq: "London, UK", founders: "Nikolay Storonsky", sector: "Financial Technology", highlights: ["35M+ customers", "95% YoY revenue growth", "First profitable year in 2023", "Banking license in UK"],
    markPrice: 35.00, annualChange: 89, valuation: "$33B", valuationNum: 33e9, fundsRaised: "$1.70B", lastRound: "$800M", roundDate: "2021",
    about: `Revolut is a global financial super-app offering banking, crypto trading, stock trading, money transfers, insurance, and more.\n\nFounded in 2015 in London, Revolut serves 35+ million personal customers across 38 countries.`,
    opportunities: "Global neobank market projected to reach $722B by 2028. Revenue diversification across payments, crypto, trading, and lending.",
    financials: "Revolut reported £1.8B in revenue for 2023, up 95% year-over-year, with its first full year of profitability.",
    risks: "Regulatory complexity across 38 countries. Competition from traditional banks and other neobanks. Crypto revenue volatility."
  },
  {
    id: "epic-games", name: "Epic Games", ticker: "UTEPIC", tagline: "Gaming and metaverse technology creator", category: "Pre-IPO",
    color: "#2F2D2E", founded: "1991", hq: "Cary, NC", founders: "Tim Sweeney", sector: "Gaming & Entertainment", highlights: ["400M+ Fortnite players", "$5.6B estimated revenue", "Unreal Engine industry standard", "$1.5B Disney metaverse deal"],
    markPrice: 22.10, annualChange: 15, valuation: "$32B", valuationNum: 32e9, fundsRaised: "$6.40B", lastRound: "$2.00B", roundDate: "2022",
    about: `Epic Games is the creator of Fortnite with 400M+ registered players and develops Unreal Engine, the industry-standard game development platform.\n\nFounded in 1991 by Tim Sweeney, Epic also operates the Epic Games Store competing with Steam.`,
    opportunities: "Fortnite's live service model generates billions annually. Unreal Engine 5 adoption across industries. Metaverse opportunities.",
    financials: "Epic Games generated an estimated $5.6B in revenue in 2023. Disney invested $1.5B in an Epic Games metaverse venture.",
    risks: "Revenue concentration in Fortnite. Ongoing antitrust litigation with Apple and Google. Epic Games Store profitability concerns."
  },
  {
    id: "plaid", name: "Plaid", ticker: "UTPLAD", tagline: "Financial data connectivity network", category: "Pre-IPO",
    color: "#111111", founded: "2013", hq: "San Francisco, CA", founders: "Zach Perret, William Hockey", sector: "Financial Infrastructure", highlights: ["$500M+ annual revenue", "12,000+ connected institutions", "8,000+ fintech clients", "Visa tried to acquire for $5.3B"],
    markPrice: 16.50, annualChange: 32, valuation: "$13.4B", valuationNum: 13.4e9, fundsRaised: "$734M", lastRound: "$425M", roundDate: "2021",
    about: `Plaid is a financial data network powering the tools millions of people rely on. The platform connects to 12,000+ financial institutions.\n\nFounded in 2013, Plaid is used by 8,000+ fintech companies including Venmo, Coinbase, and Betterment.`,
    opportunities: "Open banking regulations expanding globally. Growing fintech ecosystem requires financial data infrastructure. Network effects strengthen with each new connection.",
    financials: "Plaid generates an estimated $500M+ in annual revenue. The Visa acquisition at $5.3B was blocked by DOJ in 2021. Subsequently raised at $13.4B valuation.",
    risks: "Regulatory changes could enable direct bank-to-fintech connections. Competition from MX, Yodlee, and bank-built APIs. Data privacy scrutiny."
  }
];

// ─── Shared UI Components ─────────────────────────────────────

function Badge({ children, variant = "default" }) {
  const base = "inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";
  const variants = {
    default: "bg-indigo-50 text-indigo-700",
    green: "bg-emerald-50 text-emerald-700",
    red: "bg-red-50 text-red-700",
  };
  return <span className={`${base} ${variants[variant]}`}>{children}</span>;
}

function PriceChange({ value }) {
  const positive = value >= 0;
  return (
    <span className={`inline-flex items-center gap-0.5 text-sm font-semibold ${positive ? "text-emerald-600" : "text-red-500"}`}>
      {positive ? <TrendingUp size={14} /> : <TrendingDown size={14} />}
      {positive ? "+" : ""}{value}%
    </span>
  );
}

function InputField({ icon: Icon, label, type = "text", value, onChange, placeholder, error, ...rest }) {
  const [showPw, setShowPw] = useState(false);
  const isPassword = type === "password";

  return (
    <div>
      {label && <label className="block text-sm font-medium text-gray-700 mb-1.5">{label}</label>}
      <div className="relative">
        {Icon && <Icon size={18} className="absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-400" />}
        <input
          type={isPassword && showPw ? "text" : type}
          value={value}
          onChange={onChange}
          placeholder={placeholder}
          className={`w-full ${Icon ? "pl-10" : "pl-4"} ${isPassword ? "pr-10" : "pr-4"} py-3 border rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition ${error ? "border-red-300 bg-red-50" : "border-gray-200"}`}
          {...rest}
        />
        {isPassword && (
          <button type="button" onClick={() => setShowPw(!showPw)} className="absolute right-3.5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600">
            {showPw ? <EyeOff size={18} /> : <Eye size={18} />}
          </button>
        )}
      </div>
      {error && <p className="text-xs text-red-500 mt-1">{error}</p>}
    </div>
  );
}

function SelectField({ icon: Icon, label, value, onChange, options, error }) {
  return (
    <div>
      {label && <label className="block text-sm font-medium text-gray-700 mb-1.5">{label}</label>}
      <div className="relative">
        {Icon && <Icon size={18} className="absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none" />}
        <select
          value={value}
          onChange={onChange}
          className={`w-full ${Icon ? "pl-10" : "pl-4"} pr-4 py-3 border rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition appearance-none bg-white cursor-pointer ${error ? "border-red-300 bg-red-50" : "border-gray-200"}`}
        >
          {options.map(o => <option key={o.value} value={o.value}>{o.label}</option>)}
        </select>
      </div>
      {error && <p className="text-xs text-red-500 mt-1">{error}</p>}
    </div>
  );
}

// ─── Step Indicator ───────────────────────────────────────────
function StepIndicator({ steps, current }) {
  return (
    <div className="flex items-center justify-center gap-2 mb-8">
      {steps.map((step, i) => {
        const done = i < current;
        const active = i === current;
        return (
          <div key={i} className="flex items-center gap-2">
            <div className={`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-all ${
              done ? "bg-indigo-600 text-white" : active ? "bg-indigo-600 text-white ring-4 ring-indigo-100" : "bg-gray-100 text-gray-400"
            }`}>
              {done ? <Check size={14} /> : i + 1}
            </div>
            <span className={`text-xs font-medium hidden sm:block ${active ? "text-indigo-600" : done ? "text-gray-700" : "text-gray-400"}`}>
              {step}
            </span>
            {i < steps.length - 1 && (
              <div className={`w-8 h-0.5 rounded ${done ? "bg-indigo-600" : "bg-gray-200"}`} />
            )}
          </div>
        );
      })}
    </div>
  );
}

// Registration step labels
const REG_STEPS = ["Account", "Investor Profile", "Verification", "Complete"];

// ─── Trade Modal ──────────────────────────────────────────────
function TradeModal({ company, mode, onClose }) {
  const [amount, setAmount] = useState("");
  const [submitted, setSubmitted] = useState(false);
  const isBuy = mode === "buy";
  const shares = amount ? (parseFloat(amount) / company.markPrice).toFixed(4) : "0";

  if (submitted) {
    return (
      <div className="fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4" onClick={onClose}>
        <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 text-center" onClick={e => e.stopPropagation()}>
          <div className="w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-4">
            <svg className="w-8 h-8 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>
          </div>
          <h3 className="text-xl font-bold text-gray-900 mb-2">Order Submitted!</h3>
          <p className="text-gray-500 mb-2">{isBuy ? "Buy" : "Sell"} {shares} shares of {company.name}</p>
          <p className="text-2xl font-bold text-gray-900 mb-6">${parseFloat(amount).toLocaleString()}</p>
          <p className="text-xs text-gray-400 mb-6">This is a demo — no real transaction was made.</p>
          <button onClick={onClose} className="w-full py-3 rounded-xl font-semibold text-white bg-gray-900 hover:bg-gray-800 transition">Done</button>
        </div>
      </div>
    );
  }

  return (
    <div className="fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4" onClick={onClose}>
      <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden" onClick={e => e.stopPropagation()}>
        <div className={`px-6 py-4 flex items-center justify-between ${isBuy ? "bg-indigo-600" : "bg-rose-600"}`}>
          <h3 className="text-lg font-bold text-white">{isBuy ? "Buy" : "Sell"} {company.name}</h3>
          <button onClick={onClose} className="text-white/70 hover:text-white transition"><X size={20} /></button>
        </div>
        <div className="p-6">
          <div className="flex items-center justify-between mb-6 p-4 bg-gray-50 rounded-xl">
            <div>
              <p className="text-sm text-gray-500">Current Price</p>
              <p className="text-2xl font-bold text-gray-900">${company.markPrice.toFixed(2)}</p>
            </div>
            <PriceChange value={company.annualChange} />
          </div>
          <label className="block text-sm font-medium text-gray-700 mb-2">Amount (USD)</label>
          <div className="relative mb-2">
            <span className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"><DollarSign size={18} /></span>
            <input type="number" min="0" step="0.01" value={amount} onChange={e => setAmount(e.target.value)} placeholder="0.00"
              className="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl text-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" />
          </div>
          <div className="flex gap-2 mb-4">
            {[100, 500, 1000, 5000].map(v => (
              <button key={v} onClick={() => setAmount(String(v))} className="flex-1 py-1.5 text-xs font-medium rounded-lg border border-gray-200 hover:border-indigo-400 hover:text-indigo-600 transition">
                ${v.toLocaleString()}
              </button>
            ))}
          </div>
          {amount && parseFloat(amount) > 0 && (
            <div className="p-4 bg-gray-50 rounded-xl mb-6 space-y-2">
              <div className="flex justify-between text-sm"><span className="text-gray-500">Estimated Shares</span><span className="font-semibold text-gray-900">{shares}</span></div>
              <div className="flex justify-between text-sm"><span className="text-gray-500">Price per Share</span><span className="font-semibold text-gray-900">${company.markPrice.toFixed(2)}</span></div>
              <div className="flex justify-between text-sm border-t border-gray-200 pt-2 mt-2"><span className="text-gray-500">Total</span><span className="font-bold text-gray-900">${parseFloat(amount).toLocaleString()}</span></div>
            </div>
          )}
          <button disabled={!amount || parseFloat(amount) <= 0} onClick={() => setSubmitted(true)}
            className={`w-full py-3.5 rounded-xl font-semibold text-white transition disabled:opacity-40 disabled:cursor-not-allowed ${isBuy ? "bg-indigo-600 hover:bg-indigo-700" : "bg-rose-600 hover:bg-rose-700"}`}>
            {isBuy ? "Place Buy Order" : "Place Sell Order"}
          </button>
          <p className="text-xs text-gray-400 text-center mt-3">Demo mode — no real transactions</p>
        </div>
      </div>
    </div>
  );
}

// ─── Company Card ─────────────────────────────────────────────
function CompanyCard({ company, onClick, user, onOpenAuth }) {
  const [trade, setTrade] = useState(null);

  const handleTrade = (mode) => {
    if (!user) { onOpenAuth("register"); return; }
    setTrade(mode);
  };

  return (
    <>
      <div className="group bg-white rounded-2xl border border-gray-100 hover:border-indigo-200 hover:shadow-lg transition-all duration-300 cursor-pointer overflow-hidden" onClick={() => onClick(company.id)}>
        <div className="p-6">
          <div className="flex items-start justify-between mb-4">
            <div className="flex items-center gap-3">
              <CompanyLogo company={company} size={48} className="group-hover:scale-110 transition-transform" />
              <div>
                <h3 className="font-bold text-gray-900 text-lg">{company.name}</h3>
                <p className="text-gray-400 text-sm">{company.ticker}</p>
              </div>
            </div>
            <Badge>{company.category}</Badge>
          </div>
          <p className="text-gray-500 text-sm mb-5 line-clamp-1">{company.tagline}</p>
          <div className="grid grid-cols-2 gap-4 mb-5">
            <div><p className="text-xs text-gray-400 mb-0.5">Mark Price</p><p className="text-xl font-bold text-gray-900">${company.markPrice.toFixed(2)}</p></div>
            <div className="text-right"><p className="text-xs text-gray-400 mb-0.5">Annual Change</p><PriceChange value={company.annualChange} /></div>
          </div>
          <div className="flex items-center justify-between pt-4 border-t border-gray-50">
            <div><p className="text-xs text-gray-400">Valuation</p><p className="text-sm font-semibold text-gray-700">{company.valuation}</p></div>
            <div className="flex gap-2" onClick={e => e.stopPropagation()}>
              <button onClick={() => handleTrade("buy")} className="px-4 py-2 text-sm font-semibold rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition">Buy</button>
              <button onClick={() => handleTrade("sell")} className="px-4 py-2 text-sm font-semibold rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 hover:text-gray-800 transition">Sell</button>
            </div>
          </div>
        </div>
      </div>
      {trade && <TradeModal company={company} mode={trade} onClose={() => setTrade(null)} />}
    </>
  );
}

// ─── Analytics Dashboard ──────────────────────────────────────
function AnalyticsDashboard({ analytics, companyName }) {
  const maxRevenue = Math.max(...analytics.revenueHistory.map(r => r.value));
  const maxValuation = Math.max(...analytics.valuationHistory.map(v => v.value));

  return (
    <div className="space-y-8">
      {/* Key Metrics Grid */}
      <div>
        <h3 className="text-lg font-bold text-gray-900 mb-4">Key Performance Metrics</h3>
        <div className="grid grid-cols-2 sm:grid-cols-3 gap-3">
          {analytics.keyMetrics.map((m, i) => (
            <div key={i} className="bg-gradient-to-br from-gray-50 to-white rounded-xl p-4 border border-gray-100">
              <p className="text-xs text-gray-400 mb-1">{m.label}</p>
              <p className="text-xl font-bold text-gray-900">{m.value}</p>
              <span className={`text-xs font-semibold ${m.positive ? "text-emerald-600" : "text-red-500"}`}>{m.change}</span>
            </div>
          ))}
        </div>
      </div>

      {/* Revenue Growth Chart */}
      <div>
        <h3 className="text-lg font-bold text-gray-900 mb-1">Revenue Growth (ARR, $M)</h3>
        <p className="text-sm text-gray-400 mb-4">Quarterly annualized run rate</p>
        <div className="bg-gray-50 rounded-xl p-4 border border-gray-100">
          <div className="flex items-end gap-1.5" style={{ height: 180 }}>
            {analytics.revenueHistory.map((r, i) => {
              const height = (r.value / maxRevenue) * 100;
              return (
                <div key={i} className="flex-1 flex flex-col items-center gap-1 group">
                  <span className="text-xs font-bold text-gray-900 opacity-0 group-hover:opacity-100 transition">${r.value >= 1000 ? `${(r.value/1000).toFixed(1)}B` : `${r.value}M`}</span>
                  <div
                    className="w-full rounded-t-md bg-gradient-to-t from-indigo-600 to-indigo-400 group-hover:from-indigo-700 group-hover:to-indigo-500 transition-all relative"
                    style={{ height: `${height}%`, minHeight: 4 }}
                  />
                  <span className="text-xs text-gray-400 -rotate-45 origin-top-left mt-1 whitespace-nowrap">{r.period.replace("20","'")}</span>
                </div>
              );
            })}
          </div>
        </div>
      </div>

      {/* Valuation Timeline */}
      <div>
        <h3 className="text-lg font-bold text-gray-900 mb-1">Valuation History</h3>
        <p className="text-sm text-gray-400 mb-4">From seed to latest round</p>
        <div className="space-y-3">
          {analytics.valuationHistory.map((v, i) => (
            <div key={i} className="flex items-center gap-4">
              <div className="w-36 sm:w-44 flex-shrink-0">
                <p className="text-sm font-semibold text-gray-900">{v.round}</p>
                <p className="text-xs text-gray-400">{v.investors}</p>
              </div>
              <div className="flex-1 relative h-8">
                <div className="absolute inset-y-0 left-0 bg-gradient-to-r from-indigo-500 to-indigo-400 rounded-lg flex items-center transition-all"
                  style={{ width: `${(v.value / maxValuation) * 100}%`, minWidth: 40 }}>
                  <span className="text-xs font-bold text-white pl-3 whitespace-nowrap">${v.value}B</span>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>

      {/* Market Share */}
      <div>
        <h3 className="text-lg font-bold text-gray-900 mb-1">AI Foundation Model Market Share</h3>
        <p className="text-sm text-gray-400 mb-4">Enterprise API revenue, estimated 2025</p>
        <div className="flex rounded-xl overflow-hidden h-10 border border-gray-100">
          {analytics.marketShare.map((m, i) => {
            const colors = ["bg-gray-700", "bg-indigo-600", "bg-blue-500", "bg-emerald-500", "bg-gray-300"];
            const textColors = ["text-white", "text-white", "text-white", "text-white", "text-gray-600"];
            return (
              <div key={i} className={`${colors[i]} flex items-center justify-center transition-all hover:opacity-90`} style={{ width: `${m.share}%` }}>
                <span className={`text-xs font-bold ${textColors[i]} ${m.share < 15 ? "hidden sm:inline" : ""}`}>{m.name} {m.share}%</span>
              </div>
            );
          })}
        </div>
        <div className="flex flex-wrap gap-3 mt-3">
          {analytics.marketShare.map((m, i) => {
            const dots = ["bg-gray-700", "bg-indigo-600", "bg-blue-500", "bg-emerald-500", "bg-gray-300"];
            return (
              <div key={i} className="flex items-center gap-1.5">
                <div className={`w-2.5 h-2.5 rounded-full ${dots[i]}`} />
                <span className="text-xs text-gray-600">{m.name} ({m.share}%)</span>
              </div>
            );
          })}
        </div>
      </div>

      {/* Competitive Edge */}
      <div>
        <h3 className="text-lg font-bold text-gray-900 mb-1">Competitive Positioning</h3>
        <p className="text-sm text-gray-400 mb-4">{companyName} vs. industry average (analyst consensus)</p>
        <div className="space-y-4">
          {analytics.competitiveEdge.map((c, i) => (
            <div key={i}>
              <div className="flex justify-between mb-1.5">
                <span className="text-sm font-medium text-gray-700">{c.area}</span>
                <span className="text-sm font-bold text-indigo-600">{c.score}/100</span>
              </div>
              <div className="relative h-3 bg-gray-100 rounded-full overflow-hidden">
                <div className="absolute inset-y-0 left-0 bg-gray-300 rounded-full" style={{ width: `${c.avg}%` }} />
                <div className="absolute inset-y-0 left-0 bg-gradient-to-r from-indigo-600 to-indigo-400 rounded-full" style={{ width: `${c.score}%` }} />
              </div>
              <div className="flex justify-between mt-1">
                <span className="text-xs text-gray-400">Industry avg: {c.avg}</span>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

// ─── Detail Page ──────────────────────────────────────────────
function DetailPage({ companyId, onBack, user, onOpenAuth }) {
  const company = companies.find(c => c.id === companyId);
  const [trade, setTrade] = useState(null);
  const [activeTab, setActiveTab] = useState("about");

  const handleTrade = (mode) => {
    if (!user) { onOpenAuth("register"); return; }
    setTrade(mode);
  };

  if (!company) return null;
  const tabs = [
    { key: "about", label: "About", icon: Building2 },
    { key: "opportunities", label: "Opportunities", icon: TrendingUp },
    { key: "financials", label: "Financials", icon: BarChart3 },
    ...(company.analytics ? [{ key: "analytics", label: "Analytics", icon: BarChart3 }] : []),
    { key: "risks", label: "Risks", icon: Shield },
  ];
  const tabContent = { about: company.about, opportunities: company.opportunities, financials: company.financials, risks: company.risks };

  return (
    <>
      <div className="min-h-screen bg-gray-50">
        <div className="bg-white border-b border-gray-100">
          <div className="max-w-4xl mx-auto px-4 sm:px-6 py-4">
            <button onClick={onBack} className="flex items-center gap-2 text-gray-500 hover:text-gray-900 transition mb-6">
              <ArrowLeft size={18} /><span className="text-sm font-medium">Back to Offerings</span>
            </button>
            <div className="flex flex-col sm:flex-row sm:items-start justify-between gap-4">
              <div className="flex items-center gap-4">
                <CompanyLogo company={company} size={64} />
                <div>
                  <div className="flex items-center gap-3"><h1 className="text-2xl font-bold text-gray-900">{company.name}</h1><Badge>{company.category}</Badge></div>
                  <p className="text-gray-500 mt-1">{company.tagline}</p>
                </div>
              </div>
              <div className="flex gap-2">
                <button onClick={() => handleTrade("buy")} className="px-6 py-2.5 text-sm font-semibold rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition">Buy</button>
                <button onClick={() => handleTrade("sell")} className="px-6 py-2.5 text-sm font-semibold rounded-xl border border-gray-200 text-gray-600 hover:border-gray-300 transition">Sell</button>
              </div>
            </div>
          </div>
        </div>
        <div className="max-w-4xl mx-auto px-4 sm:px-6 py-6">
          <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3">
            {[
              { label: "Mark Price", value: `$${company.markPrice.toFixed(2)}` },
              { label: "Annual Change", value: `${company.annualChange >= 0 ? "+" : ""}${company.annualChange}%`, color: company.annualChange >= 0 ? "text-emerald-600" : "text-red-500" },
              { label: "Valuation", value: company.valuation },
              { label: "Funds Raised", value: company.fundsRaised },
              { label: "Last Round", value: company.lastRound },
              { label: "Round Date", value: company.roundDate },
            ].map((stat, i) => (
              <div key={i} className="bg-white rounded-xl p-4 border border-gray-100">
                <p className="text-xs text-gray-400 mb-1">{stat.label}</p>
                <p className={`text-lg font-bold ${stat.color || "text-gray-900"}`}>{stat.value}</p>
              </div>
            ))}
          </div>
        </div>
        <div className="max-w-4xl mx-auto px-4 sm:px-6 pb-16">
          <div className="bg-white rounded-2xl border border-gray-100 overflow-hidden">
            <div className="flex bg-gray-50 p-1.5 gap-1 overflow-x-auto rounded-t-2xl">
              {tabs.map(tab => {
                const Icon = tab.icon;
                return (
                  <button key={tab.key} onClick={() => setActiveTab(tab.key)}
                    className={`flex items-center gap-2 px-5 py-3 text-sm font-semibold whitespace-nowrap rounded-xl transition-all ${activeTab === tab.key ? "bg-white text-indigo-600 shadow-sm ring-1 ring-gray-200" : "text-gray-500 hover:text-gray-800 hover:bg-white/60"}`}>
                    <Icon size={17} />{tab.label}
                  </button>
                );
              })}
            </div>
            <div className="p-6 sm:p-8">
              {activeTab === "about" ? (
                <div className="space-y-6">
                  {/* Hero banner */}
                  <div className="rounded-2xl p-6 sm:p-8 text-white relative overflow-hidden" style={{background: `linear-gradient(135deg, ${company.color || '#6366f1'}, ${company.color ? company.color+'cc' : '#818cf8'})`}}>
                    <div className="absolute inset-0 opacity-10" style={{backgroundImage:'radial-gradient(circle at 20% 50%, white 1px, transparent 1px), radial-gradient(circle at 80% 20%, white 1px, transparent 1px)', backgroundSize:'60px 60px'}} />
                    <div className="relative">
                      <div className="flex flex-wrap gap-2 mb-4">
                        {company.sector && <span className="px-3 py-1 rounded-full text-xs font-bold bg-white/20 backdrop-blur-sm">{company.sector}</span>}
                        {company.founded && <span className="px-3 py-1 rounded-full text-xs font-bold bg-white/20 backdrop-blur-sm">Est. {company.founded}</span>}
                        {company.hq && <span className="px-3 py-1 rounded-full text-xs font-bold bg-white/20 backdrop-blur-sm">{company.hq}</span>}
                      </div>
                      <h3 className="text-2xl sm:text-3xl font-bold mb-2">{company.name}</h3>
                      <p className="text-white/80 text-lg">{company.tagline}</p>
                      {company.founders && <p className="text-white/60 text-sm mt-3">Founded by {company.founders}</p>}
                    </div>
                  </div>

                  {/* Key highlights */}
                  {company.highlights && company.highlights.length > 0 && (
                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                      {company.highlights.map((h, i) => (
                        <div key={i} className="flex items-start gap-3 p-4 rounded-xl border border-gray-100 bg-gradient-to-br from-white to-gray-50 hover:shadow-md transition-shadow">
                          <div className="w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 text-white font-bold text-sm" style={{background: company.color || '#6366f1'}}>{i+1}</div>
                          <p className="text-sm font-medium text-gray-700 pt-1">{h}</p>
                        </div>
                      ))}
                    </div>
                  )}

                  {/* Company description */}
                  <div className="space-y-4">
                    <h4 className="text-lg font-bold text-gray-900 flex items-center gap-2"><Building2 size={18} style={{color: company.color || '#6366f1'}} /> Company Overview</h4>
                    {company.about.split("\n\n").map((paragraph, i) => (
                      <p key={i} className="text-gray-600 leading-relaxed">{paragraph}</p>
                    ))}
                  </div>

                  {/* Quick stats row */}
                  <div className="grid grid-cols-3 gap-3">
                    <div className="text-center p-4 rounded-xl" style={{background: (company.color || '#6366f1') + '10'}}>
                      <p className="text-2xl font-bold" style={{color: company.color || '#6366f1'}}>{company.valuation}</p>
                      <p className="text-xs text-gray-500 mt-1">Valuation</p>
                    </div>
                    <div className="text-center p-4 rounded-xl" style={{background: (company.color || '#6366f1') + '10'}}>
                      <p className="text-2xl font-bold" style={{color: company.color || '#6366f1'}}>{company.fundsRaised}</p>
                      <p className="text-xs text-gray-500 mt-1">Funds Raised</p>
                    </div>
                    <div className="text-center p-4 rounded-xl" style={{background: (company.color || '#6366f1') + '10'}}>
                      <p className="text-2xl font-bold" style={{color: company.color || '#6366f1'}}>{company.annualChange >= 0 ? '+' : ''}{company.annualChange}%</p>
                      <p className="text-xs text-gray-500 mt-1">Annual Change</p>
                    </div>
                  </div>
                </div>
              ) : activeTab === "analytics" && company.analytics ? (
                <AnalyticsDashboard analytics={company.analytics} companyName={company.name} />
              ) : (
                tabContent[activeTab].split("\n\n").map((paragraph, i) => (
                  <p key={i} className="text-gray-600 leading-relaxed mb-4 last:mb-0">{paragraph}</p>
                ))
              )}
            </div>
          </div>
          <div className="mt-6 p-4 bg-amber-50 rounded-xl border border-amber-100">
            <p className="text-xs text-amber-700"><strong>Disclaimer:</strong> This is a demo application with sample data. Pre-IPO investments carry significant risk. Always consult a qualified financial advisor.</p>
          </div>
        </div>
      </div>
      {trade && <TradeModal company={company} mode={trade} onClose={() => setTrade(null)} />}
    </>
  );
}

// ─── Dashboard (Always Visible) ──────────────────────────────
function Dashboard({ user, onLogout, onOpenAuth, onNavigate }) {
  const [search, setSearch] = useState("");
  const [selectedCompany, setSelectedCompany] = useState(null);
  const [sortBy, setSortBy] = useState("name");
  const [selectedCategory, setSelectedCategory] = useState("All");

  const categoryTabs = ["All", "Pre-IPO", "Tokens"];

  const filtered = useMemo(() => {
    let list = companies.filter(c => {
      const matchesSearch = c.name.toLowerCase().includes(search.toLowerCase()) ||
        c.tagline.toLowerCase().includes(search.toLowerCase()) ||
        c.ticker.toLowerCase().includes(search.toLowerCase());
      const matchesCategory = selectedCategory === "All" || c.category === selectedCategory;
      return matchesSearch && matchesCategory;
    });
    return list.sort((a, b) => {
      switch (sortBy) {
        case "price": return b.markPrice - a.markPrice;
        case "change": return b.annualChange - a.annualChange;
        case "valuation": return b.valuationNum - a.valuationNum;
        default: return 0;
      }
    });
  }, [search, sortBy, selectedCategory]);

  if (selectedCompany) {
    return <DetailPage companyId={selectedCompany} onBack={() => setSelectedCompany(null)} user={user} onOpenAuth={onOpenAuth} />;
  }

  return (
    <div className="min-h-screen bg-gray-50">
      <header className="bg-white border-b border-gray-100 sticky top-0 z-40">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 py-4 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="w-9 h-9 rounded-lg bg-indigo-600 flex items-center justify-center">
              <TrendingUp size={18} className="text-white" />
            </div>
            <h1 className="text-xl font-bold text-gray-900">InvestHub</h1>
            <button onClick={() => onNavigate("howitworks")} className="ml-6 text-sm font-medium text-gray-500 hover:text-indigo-600 transition hidden sm:block">How It Works</button>
          </div>
          {user ? (
            <div className="flex items-center gap-4">
              <div className="flex items-center gap-2">
                <div className="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center">
                  <span className="text-xs font-bold text-indigo-600">{(user.firstName || user.name || "U")[0].toUpperCase()}</span>
                </div>
                <span className="text-sm font-medium text-gray-700 hidden sm:block">{user.firstName || user.name}</span>
              </div>
              <button onClick={onLogout} className="flex items-center gap-1.5 text-sm text-gray-400 hover:text-red-500 transition" title="Sign out">
                <LogOut size={16} />
              </button>
            </div>
          ) : (
            <div className="flex items-center gap-3">
              <button onClick={() => onOpenAuth("login")} className="px-4 py-2 text-sm font-semibold text-gray-600 hover:text-gray-900 transition">
                Sign In
              </button>
              <button onClick={() => onOpenAuth("register")} className="px-4 py-2 text-sm font-semibold text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition">
                Sign Up
              </button>
            </div>
          )}
        </div>
      </header>

      <div className="max-w-7xl mx-auto px-4 sm:px-6 pt-10 pb-6">
        <h2 className="text-3xl sm:text-4xl font-bold text-gray-900 mb-2">Investment Offerings</h2>
        <p className="text-gray-500 text-lg mb-6">Discover and invest in high-growth private companies and tokenized mineral assets.</p>
        <div className="flex gap-2 mb-6">
          {categoryTabs.map(cat => (
            <button key={cat} onClick={() => setSelectedCategory(cat)}
              className={`px-5 py-2 rounded-full text-sm font-medium transition-all ${selectedCategory === cat ? "bg-indigo-600 text-white shadow-md" : "bg-gray-100 text-gray-600 hover:bg-gray-200"}`}>
              {cat} {cat === "All" ? `(${companies.length})` : `(${companies.filter(c => c.category === cat).length})`}
            </button>
          ))}
        </div>
        <div className="flex flex-col sm:flex-row gap-3">
          <div className="relative flex-1">
            <Search size={18} className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400" />
            <input type="text" placeholder="Search companies by name or ticker..." value={search} onChange={e => setSearch(e.target.value)}
              className="w-full pl-11 pr-4 py-3 bg-white border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" />
          </div>
          <select value={sortBy} onChange={e => setSortBy(e.target.value)}
            className="px-4 py-3 bg-white border border-gray-200 rounded-xl text-sm text-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer">
            <option value="name">Sort by Name</option>
            <option value="price">Sort by Price</option>
            <option value="change">Sort by Performance</option>
            <option value="valuation">Sort by Valuation</option>
          </select>
        </div>
      </div>

      <div className="max-w-7xl mx-auto px-4 sm:px-6 pb-16">
        {filtered.length === 0 ? (
          <div className="text-center py-16"><p className="text-gray-400 text-lg">No companies match your search.</p></div>
        ) : (
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
            {filtered.map(company => (
              <CompanyCard key={company.id} company={company} onClick={setSelectedCompany} user={user} onOpenAuth={onOpenAuth} />
            ))}
          </div>
        )}
      </div>

      <footer className="border-t border-gray-100 bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 py-6 flex flex-col sm:flex-row justify-between items-center text-sm text-gray-400">
          <p>InvestHub Demo — Not real financial advice or offerings.</p>
          <p className="mt-2 sm:mt-0">Built with React</p>
        </div>
      </footer>
    </div>
  );
}

// ─── Auth Modal Wrapper ───────────────────────────────────────
function AuthModal({ mode, onClose, onLogin, onComplete }) {
  return (
    <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4" onClick={onClose}>
      <div className="relative w-full max-w-md max-h-[90vh] overflow-y-auto" onClick={e => e.stopPropagation()}>
        <button onClick={onClose} className="absolute top-4 right-4 z-10 w-8 h-8 rounded-full bg-white/80 hover:bg-white flex items-center justify-center text-gray-500 hover:text-gray-700 shadow-sm transition">
          <X size={16} />
        </button>
        {mode === "login" ? (
          <LoginPageInline onLogin={(u) => { onLogin(u); onClose(); }} onGoToRegister={() => onComplete("switch-register")} />
        ) : (
          <RegisterPageInline onComplete={(u) => { onLogin(u); onClose(); }} onGoToLogin={() => onComplete("switch-login")} />
        )}
      </div>
    </div>
  );
}

// Inline versions of Login/Register (no AuthShell wrapper, just the card)
function LoginPageInline({ onLogin, onGoToRegister }) {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [errors, setErrors] = useState({});
  const [loading, setLoading] = useState(false);

  const handleSubmit = (e) => {
    e.preventDefault();
    const errs = {};
    if (!email.trim()) errs.email = "Email is required";
    if (!password) errs.password = "Password is required";
    setErrors(errs);
    if (Object.keys(errs).length > 0) return;
    setLoading(true);
    setTimeout(() => { onLogin({ email, name: email.split("@")[0], firstName: email.split("@")[0] }); }, 800);
  };

  return (
    <div className="bg-white rounded-2xl shadow-2xl border border-gray-100 p-8">
      <div className="flex items-center justify-center gap-3 mb-6">
        <div className="w-9 h-9 rounded-lg bg-indigo-600 flex items-center justify-center"><TrendingUp size={18} className="text-white" /></div>
        <span className="text-xl font-bold text-gray-900">InvestHub</span>
      </div>
      <h2 className="text-2xl font-bold text-gray-900 text-center mb-1">Welcome back</h2>
      <p className="text-gray-500 text-center text-sm mb-6">Sign in to start trading</p>
      <form onSubmit={handleSubmit} className="space-y-4">
        <InputField icon={Mail} label="Email" type="email" value={email} onChange={e => setEmail(e.target.value)} placeholder="you@example.com" error={errors.email} />
        <InputField icon={Lock} label="Password" type="password" value={password} onChange={e => setPassword(e.target.value)} placeholder="Enter your password" error={errors.password} />
        <button type="submit" disabled={loading} className="w-full py-3 rounded-xl font-semibold text-white bg-indigo-600 hover:bg-indigo-700 transition disabled:opacity-60">
          {loading ? "Signing in..." : "Sign In"}
        </button>
      </form>
      <div className="mt-5 text-center">
        <p className="text-sm text-gray-500">Don't have an account? <button onClick={onGoToRegister} className="text-indigo-600 hover:text-indigo-700 font-semibold">Create one</button></p>
      </div>
    </div>
  );
}

function RegisterPageInline({ onComplete, onGoToLogin }) {
  const [step, setStep] = useState(0);
  const [errors, setErrors] = useState({});
  const [firstName, setFirstName] = useState("");
  const [lastName, setLastName] = useState("");
  const [email, setEmail] = useState("");
  const [phone, setPhone] = useState("");
  const [password, setPassword] = useState("");
  const [confirmPassword, setConfirmPassword] = useState("");
  const [experience, setExperience] = useState("");
  const [riskTolerance, setRiskTolerance] = useState("");
  const [investGoal, setInvestGoal] = useState("");
  const [annualIncome, setAnnualIncome] = useState("");
  const [netWorth, setNetWorth] = useState("");
  const [idType, setIdType] = useState("");
  const [idNumber, setIdNumber] = useState("");
  const [acceptedTerms, setAcceptedTerms] = useState(false);
  const [acceptedRisk, setAcceptedRisk] = useState(false);

  const validateStep = () => {
    const errs = {};
    if (step === 0) {
      if (!firstName.trim()) errs.firstName = "Required";
      if (!lastName.trim()) errs.lastName = "Required";
      if (!email.trim()) errs.email = "Required";
      else if (!/\S+@\S+\.\S+/.test(email)) errs.email = "Invalid email";
      if (!password) errs.password = "Required";
      else if (password.length < 8) errs.password = "Minimum 8 characters";
      if (password !== confirmPassword) errs.confirmPassword = "Passwords don't match";
    }
    if (step === 1) {
      if (!experience) errs.experience = "Please select your experience";
      if (!riskTolerance) errs.riskTolerance = "Please select risk tolerance";
      if (!investGoal) errs.investGoal = "Please select your investment goal";
    }
    if (step === 2) {
      if (!idType) errs.idType = "Please select ID type";
      if (!idNumber.trim()) errs.idNumber = "Required";
      if (!acceptedTerms) errs.terms = "You must accept the terms";
      if (!acceptedRisk) errs.risk = "You must acknowledge the risk disclosure";
    }
    setErrors(errs);
    return Object.keys(errs).length === 0;
  };

  const next = () => { if (validateStep()) setStep(s => s + 1); };
  const prev = () => { setErrors({}); setStep(s => s - 1); };

  const pwStrength = useMemo(() => {
    if (!password) return { score: 0, label: "", color: "" };
    let score = 0;
    if (password.length >= 8) score++;
    if (/[A-Z]/.test(password)) score++;
    if (/[0-9]/.test(password)) score++;
    if (/[^A-Za-z0-9]/.test(password)) score++;
    const labels = ["", "Weak", "Fair", "Good", "Strong"];
    const colors = ["", "bg-red-400", "bg-amber-400", "bg-blue-400", "bg-emerald-400"];
    return { score, label: labels[score], color: colors[score] };
  }, [password]);

  return (
    <div className="bg-white rounded-2xl shadow-2xl border border-gray-100 p-8">
      <div className="flex items-center justify-center gap-3 mb-4">
        <div className="w-9 h-9 rounded-lg bg-indigo-600 flex items-center justify-center"><TrendingUp size={18} className="text-white" /></div>
        <span className="text-xl font-bold text-gray-900">InvestHub</span>
      </div>
      <h2 className="text-2xl font-bold text-gray-900 text-center mb-1">Create Account</h2>
      <p className="text-gray-500 text-center text-sm mb-6">Start investing in pre-IPO companies</p>

      <StepIndicator steps={REG_STEPS} current={step} />

      {step === 0 && (
        <div className="space-y-4">
          <div className="grid grid-cols-2 gap-3">
            <InputField icon={User} label="First Name" value={firstName} onChange={e => setFirstName(e.target.value)} placeholder="John" error={errors.firstName} />
            <InputField label="Last Name" value={lastName} onChange={e => setLastName(e.target.value)} placeholder="Doe" error={errors.lastName} />
          </div>
          <InputField icon={Mail} label="Email" type="email" value={email} onChange={e => setEmail(e.target.value)} placeholder="you@example.com" error={errors.email} />
          <InputField label="Phone (optional)" type="tel" value={phone} onChange={e => setPhone(e.target.value)} placeholder="+1 (555) 000-0000" />
          <InputField icon={Lock} label="Password" type="password" value={password} onChange={e => setPassword(e.target.value)} placeholder="Min. 8 characters" error={errors.password} />
          {password && (
            <div className="flex items-center gap-2">
              <div className="flex-1 flex gap-1">{[1,2,3,4].map(i => (<div key={i} className={`h-1.5 flex-1 rounded-full transition ${i <= pwStrength.score ? pwStrength.color : "bg-gray-100"}`} />))}</div>
              <span className="text-xs text-gray-500">{pwStrength.label}</span>
            </div>
          )}
          <InputField icon={Lock} label="Confirm Password" type="password" value={confirmPassword} onChange={e => setConfirmPassword(e.target.value)} placeholder="Re-enter password" error={errors.confirmPassword} />
          <button onClick={next} className="w-full py-3 rounded-xl font-semibold text-white bg-indigo-600 hover:bg-indigo-700 transition flex items-center justify-center gap-2">Continue <ArrowRight size={16} /></button>
          <p className="text-sm text-gray-500 text-center">Already have an account? <button onClick={onGoToLogin} className="text-indigo-600 hover:text-indigo-700 font-semibold">Sign in</button></p>
        </div>
      )}

      {step === 1 && (
        <div className="space-y-4">
          <div className="p-4 bg-indigo-50 rounded-xl mb-2"><p className="text-sm text-indigo-700">This helps us tailor recommendations and ensure regulatory compliance.</p></div>
          <SelectField icon={Briefcase} label="Investment Experience" value={experience} onChange={e => setExperience(e.target.value)} error={errors.experience} options={[
            { value: "", label: "Select experience level..." }, { value: "none", label: "No experience" }, { value: "beginner", label: "Beginner (< 1 year)" },
            { value: "intermediate", label: "Intermediate (1-5 years)" }, { value: "advanced", label: "Advanced (5+ years)" }, { value: "professional", label: "Professional / Institutional" },
          ]} />
          <SelectField icon={Target} label="Risk Tolerance" value={riskTolerance} onChange={e => setRiskTolerance(e.target.value)} error={errors.riskTolerance} options={[
            { value: "", label: "Select risk tolerance..." }, { value: "conservative", label: "Conservative — Preserve capital" },
            { value: "moderate", label: "Moderate — Balanced growth" }, { value: "aggressive", label: "Aggressive — Maximum growth" }, { value: "speculative", label: "Speculative — High risk, high reward" },
          ]} />
          <SelectField icon={TrendingUp} label="Primary Investment Goal" value={investGoal} onChange={e => setInvestGoal(e.target.value)} error={errors.investGoal} options={[
            { value: "", label: "Select your goal..." }, { value: "growth", label: "Long-term capital growth" }, { value: "income", label: "Regular income / dividends" },
            { value: "diversification", label: "Portfolio diversification" }, { value: "speculation", label: "Speculative / early-stage bets" },
          ]} />
          <SelectField label="Annual Income (optional)" value={annualIncome} onChange={e => setAnnualIncome(e.target.value)} options={[
            { value: "", label: "Prefer not to say" }, { value: "under50k", label: "Under $50,000" }, { value: "50k-100k", label: "$50,000 – $100,000" },
            { value: "100k-250k", label: "$100,000 – $250,000" }, { value: "250k-1m", label: "$250,000 – $1,000,000" }, { value: "over1m", label: "Over $1,000,000" },
          ]} />
          <SelectField label="Net Worth (optional)" value={netWorth} onChange={e => setNetWorth(e.target.value)} options={[
            { value: "", label: "Prefer not to say" }, { value: "under100k", label: "Under $100,000" }, { value: "100k-500k", label: "$100,000 – $500,000" },
            { value: "500k-2m", label: "$500,000 – $2,000,000" }, { value: "2m-10m", label: "$2,000,000 – $10,000,000" }, { value: "over10m", label: "Over $10,000,000" },
          ]} />
          <div className="flex gap-3">
            <button onClick={prev} className="flex-1 py-3 rounded-xl font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 transition flex items-center justify-center gap-2"><ArrowLeft size={16} /> Back</button>
            <button onClick={next} className="flex-[2] py-3 rounded-xl font-semibold text-white bg-indigo-600 hover:bg-indigo-700 transition flex items-center justify-center gap-2">Continue <ArrowRight size={16} /></button>
          </div>
        </div>
      )}

      {step === 2 && (
        <div className="space-y-4">
          <div className="p-4 bg-amber-50 rounded-xl border border-amber-100 mb-2">
            <div className="flex items-start gap-2"><AlertTriangle size={16} className="text-amber-600 mt-0.5 flex-shrink-0" /><p className="text-sm text-amber-700">Identity verification is required by regulations. Your data is encrypted and stored securely.</p></div>
          </div>
          <SelectField icon={FileText} label="ID Document Type" value={idType} onChange={e => setIdType(e.target.value)} error={errors.idType} options={[
            { value: "", label: "Select document type..." }, { value: "passport", label: "Passport" }, { value: "drivers_license", label: "Driver's License" },
            { value: "national_id", label: "National ID Card" }, { value: "residence_permit", label: "Residence Permit" },
          ]} />
          <InputField icon={FileText} label="Document Number" value={idNumber} onChange={e => setIdNumber(e.target.value)} placeholder="Enter document number" error={errors.idNumber} />
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1.5">Upload Document (optional)</label>
            <div className="border-2 border-dashed border-gray-200 rounded-xl p-6 text-center hover:border-indigo-300 transition cursor-pointer">
              <Upload size={24} className="mx-auto text-gray-400 mb-2" /><p className="text-sm text-gray-500">Drag & drop or click to upload</p><p className="text-xs text-gray-400 mt-1">JPG, PNG or PDF, max 10MB</p>
            </div>
          </div>
          <div className="space-y-3 pt-2">
            <label className="flex items-start gap-3 cursor-pointer">
              <input type="checkbox" checked={acceptedTerms} onChange={e => setAcceptedTerms(e.target.checked)} className="w-4 h-4 mt-0.5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500" />
              <span className="text-sm text-gray-600">I agree to the <span className="text-indigo-600 font-medium">Terms of Service</span> and <span className="text-indigo-600 font-medium">Privacy Policy</span></span>
            </label>
            {errors.terms && <p className="text-xs text-red-500 ml-7">{errors.terms}</p>}
            <label className="flex items-start gap-3 cursor-pointer">
              <input type="checkbox" checked={acceptedRisk} onChange={e => setAcceptedRisk(e.target.checked)} className="w-4 h-4 mt-0.5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500" />
              <span className="text-sm text-gray-600">I acknowledge that pre-IPO investments are <strong>high risk</strong> and I may lose my entire investment.</span>
            </label>
            {errors.risk && <p className="text-xs text-red-500 ml-7">{errors.risk}</p>}
          </div>
          <div className="flex gap-3">
            <button onClick={prev} className="flex-1 py-3 rounded-xl font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 transition flex items-center justify-center gap-2"><ArrowLeft size={16} /> Back</button>
            <button onClick={next} className="flex-[2] py-3 rounded-xl font-semibold text-white bg-indigo-600 hover:bg-indigo-700 transition flex items-center justify-center gap-2">Submit Verification <ArrowRight size={16} /></button>
          </div>
        </div>
      )}

      {step === 3 && (
        <div className="text-center py-4">
          <div className="w-20 h-20 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-6">
            <svg className="w-10 h-10 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>
          </div>
          <h3 className="text-2xl font-bold text-gray-900 mb-2">You're All Set!</h3>
          <p className="text-gray-500 mb-2">Welcome to InvestHub, {firstName}.</p>
          <p className="text-sm text-gray-400 mb-8">Your account is created and verification is being processed. Start investing right away.</p>
          <div className="bg-gray-50 rounded-xl p-4 mb-6 text-left space-y-2">
            <div className="flex justify-between text-sm"><span className="text-gray-500">Account</span><span className="font-medium text-gray-900">{email}</span></div>
            <div className="flex justify-between text-sm"><span className="text-gray-500">Investor Profile</span><span className="font-medium text-gray-900 capitalize">{riskTolerance} risk</span></div>
            <div className="flex justify-between text-sm"><span className="text-gray-500">Verification</span><Badge variant="green">Pending review</Badge></div>
          </div>
          <button onClick={() => onComplete({ firstName, lastName, email })} className="w-full py-3.5 rounded-xl font-semibold text-white bg-indigo-600 hover:bg-indigo-700 transition flex items-center justify-center gap-2">
            Start Investing <ArrowRight size={16} />
          </button>
        </div>
      )}
    </div>
  );
}

// ─── How It Works Page ────────────────────────────────────────
function HowItWorksPage({ onNavigate }) {
  const [activeSection, setActiveSection] = useState("mining");

  const sections = [
    { id: "mining", label: "Месторождения", icon: "⛏" },
    { id: "recycling", label: "Переработка отходов", icon: "♻" },
    { id: "preipo", label: "Pre-IPO", icon: "📈" },
  ];

  return (
    <div className="min-h-screen bg-gray-50 text-gray-900">
      {/* Header */}
      <header className="bg-white border-b border-gray-100 sticky top-0 z-40">
        <div className="max-w-6xl mx-auto px-4 sm:px-6 py-4 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <button onClick={() => onNavigate("dashboard")} className="flex items-center gap-2 text-gray-500 hover:text-gray-900 transition">
              <ArrowLeft size={18} />
            </button>
            <div className="w-9 h-9 rounded-lg bg-indigo-600 flex items-center justify-center">
              <TrendingUp size={18} className="text-white" />
            </div>
            <h1 className="text-xl font-bold">InvestHub</h1>
          </div>
          <button onClick={() => onNavigate("dashboard")} className="px-4 py-2 text-sm font-medium text-gray-500 hover:text-gray-900 transition">
            К инвестициям
          </button>
        </div>
      </header>

      {/* Hero */}
      <div className="max-w-6xl mx-auto px-4 sm:px-6 pt-12 pb-8 text-center">
        <h2 className="text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-gray-900 to-indigo-600 bg-clip-text text-transparent">Как это работает</h2>
        <p className="text-gray-500 text-lg max-w-2xl mx-auto">Узнайте о процессе инвестирования в каждый класс активов на нашей платформе</p>
      </div>

      {/* Section Tabs */}
      <div className="max-w-6xl mx-auto px-4 sm:px-6 mb-10">
        <div className="flex gap-3 justify-center flex-wrap">
          {sections.map(s => (
            <button key={s.id} onClick={() => setActiveSection(s.id)}
              className={`px-6 py-3 rounded-xl text-sm font-semibold transition-all flex items-center gap-2 ${
                activeSection === s.id
                  ? "bg-indigo-600 text-white shadow-lg shadow-indigo-600/30"
                  : "bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-900"
              }`}>
              <span className="text-lg">{s.icon}</span> {s.label}
            </button>
          ))}
        </div>
      </div>

      {/* Content */}
      <div className="max-w-6xl mx-auto px-4 sm:px-6 pb-20">
        {activeSection === "mining" && <MiningSection />}
        {activeSection === "recycling" && <RecyclingSection />}
        {activeSection === "preipo" && <PreIPOSection />}
      </div>

      {/* Footer */}
      <footer className="border-t border-gray-100 bg-white">
        <div className="max-w-6xl mx-auto px-4 sm:px-6 py-6 flex flex-col sm:flex-row justify-between items-center text-sm text-gray-500">
          <p>InvestHub — Образовательный контент. Не является финансовой рекомендацией.</p>
          <button onClick={() => onNavigate("dashboard")} className="mt-2 sm:mt-0 text-indigo-600 hover:text-indigo-700 transition">
            ← К инвестициям
          </button>
        </div>
      </footer>
    </div>
  );
}

// ─── Mining Section ───────────────────────────────────────────
function MiningSection() {
  return (
    <div className="space-y-10">
      {/* Intro */}
      <div className="bg-gradient-to-br from-amber-50 to-white border border-amber-200 rounded-2xl p-8">
        <div className="text-xs font-semibold tracking-widest text-amber-600 uppercase mb-3">Токены месторождений</div>
        <h3 className="text-2xl font-bold mb-3">От геологоразведки до подтверждённых запасов</h3>
        <p className="text-gray-500 leading-relaxed max-w-3xl">
          Инвестирование в месторождения полезных ископаемых следует цепочке этапов геологоразведки. Каждый этап резко увеличивает стоимость горнодобывающей лицензии и снижает риск. Благодаря токенизации инвесторы получают фракционный доступ к этим активам — от лицензий на раннюю разведку (низкая стоимость, высокий риск) к запасам стоимостью в миллиарды.
        </p>
      </div>

      {/* Pyramid of Categories */}
      <div>
        <h3 className="text-xl font-bold mb-2">Пирамида надёжности</h3>
        <p className="text-gray-500 text-sm mb-6">Российская классификация делит подземные ресурсы на <span className="text-emerald-600 font-medium">Запасы</span> (подтверждённые) и <span className="text-red-600 font-medium">Ресурсы</span> (прогнозные). Более высокая категория = дороже и надёжнее.</p>
        <div className="space-y-2 flex flex-col items-center">
          {[
            { cat: "A", name: "Полностью разведанные", desc: "Границы, качество и условия добычи полностью определены. Месторождение в добыче.", pct: "~95%", color: "emerald", w: "45%" },
            { cat: "B", name: "Предварительно разведанные", desc: "Контуры определены, пространственное положение примерно установлено.", pct: "~80%", color: "emerald", w: "52%" },
            { cat: "C₁", name: "Разведанные запасы", desc: "Основная часть разведанных месторождений. Продуктивность подтверждена бурением.", pct: "~60%", color: "blue", w: "60%" },
            { cat: "C₂", name: "Оценённые запасы", desc: "Перспективные площади рядом с разведанными. Экономическая значимость обоснована, но не полностью подтверждена.", pct: "~35%", color: "amber", w: "70%" },
            { cat: "P₁", name: "Прогнозные ресурсы", desc: "Расширение за границы C₂. Оценено по аналогии.", pct: "~15%", color: "red", w: "80%" },
            { cat: "P₂", name: "Предполагаемые ресурсы", desc: "На основе геологических предпосылок и аналогии с изученными территориями.", pct: "~5%", color: "red", w: "88%" },
            { cat: "P₃", name: "Потенциальные ресурсы", desc: "Перспективные территории. Наличие предполагается региональной геологией.", pct: "~1%", color: "gray", w: "96%" },
          ].map((lv, i) => (
            <div key={i} className={`flex items-center gap-4 p-4 rounded-xl border border-${lv.color}-200 bg-${lv.color}-50 hover:-translate-y-0.5 transition`} style={{ width: lv.w, minWidth: "280px" }}>
              <span className={`text-2xl font-black text-${lv.color}-600 min-w-[48px] text-center`}>{lv.cat}</span>
              <div className="flex-1 min-w-0">
                <div className="text-sm font-semibold">{lv.name}</div>
                <div className="text-xs text-gray-500 line-clamp-2">{lv.desc}</div>
              </div>
              <span className={`text-xs font-bold px-2 py-1 rounded-md bg-${lv.color}-100 text-${lv.color}-600 whitespace-nowrap`}>{lv.pct}</span>
            </div>
          ))}
        </div>
        <div className="flex justify-center gap-6 mt-4">
          <span className="text-xs font-semibold tracking-wider uppercase px-3 py-1.5 rounded-md bg-emerald-50 text-emerald-600 border border-emerald-200">▲ Запасы (A, B, C₁, C₂)</span>
          <span className="text-xs font-semibold tracking-wider uppercase px-3 py-1.5 rounded-md bg-red-50 text-red-600 border border-red-200">▼ Ресурсы (P₁, P₂, P₃)</span>
        </div>
      </div>

      {/* Value Multiplier */}
      <div>
        <h3 className="text-xl font-bold mb-2">Эффект мультипликации</h3>
        <p className="text-gray-500 text-sm mb-6">Каждый этап геологоразведки трансформирует дешёвый высокорисковый актив в ценный актив с подтверждённой стоимостью.</p>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
          {[
            { label: "Лицензия P₁/P₂", price: "100-500K ₽", note: "Поисковая лицензия на геологоразведку", color: "red" },
            { label: "Запасы C₂/C₁", price: "50-500M ₽", note: "Подтверждённые запасы, стоимость аукциона", color: "amber" },
            { label: "Добыча (A/B)", price: "Миллиарды ₽+", note: "Действующее месторождение, приносящее выручку", color: "emerald" },
          ].map((v, i) => (
            <div key={i} className={`bg-white border border-gray-200 rounded-xl p-6 text-center hover:-translate-y-1 transition`}>
              <div className="text-xs font-semibold tracking-widest text-gray-500 uppercase mb-2">{v.label}</div>
              <div className={`text-2xl font-bold text-${v.color}-600 mb-1`}>{v.price}</div>
              <div className="text-xs text-gray-500">{v.note}</div>
            </div>
          ))}
        </div>
        <div className="bg-amber-50 border border-amber-200 rounded-xl p-5 text-center">
          <div className="text-sm font-semibold text-amber-600 mb-1">Мультипликатор: ×100 to ×10 000</div>
          <p className="text-xs text-gray-500 max-w-xl mx-auto">Затраты на геологоразведку (бурение, лабораторные анализы, документация) могут быть 20-200M ₽, но финальная стоимость подтверждённого месторождения измеряется в сотнях миллионов и миллиардах.</p>
        </div>
      </div>

      {/* Development Stages */}
      <div>
        <h3 className="text-xl font-bold mb-2">Стадии освоения</h3>
        <p className="text-gray-500 text-sm mb-6">Пошаговый путь от идеи к промышленной добыче.</p>
        <div className="space-y-4">
          {[
            { stage: 1, title: "Получение поисковой лицензии", desc: "Лицензия на геологоразведку получается на аукционе Роснедра или через заявку. Площадь содержит только прогнозные ресурсы P₁–P₃.", meta: ["3-6 месяцев", "Лицензия 5-7 лет", "От 100K ₽"], color: "gray" },
            { stage: 2, title: "Геологоразведочные работы (ГРР)", desc: "Геологи проводят полевые работы: геологическое обследование, геофизика, геохимия, бурение, отбор проб. Цель: преобразовать ресурсы P₁ в запасы C₂.", meta: ["2-5 лет", "Геологи, геофизики", "20-200M ₽"], color: "red" },
            { stage: 3, title: "Постановка запасов на баланс (ГКЗ)", desc: "Расчёт запасов C₂ (или C₁) и их утверждение Государственной комиссией. Запасы вносятся в Государственный баланс минеральных ресурсов.", meta: ["6-12 месяцев", "Экспертиза ГКЗ/ТКЗ", "Государственный баланс"], color: "amber" },
            { stage: 4, title: "Разведка месторождения", desc: "Детальное изучение: разведочное бурение, геологическое обследование 1:10 000, технологическое тестирование, технико-хозяйственное обоснование. Цель: C₂ → C₁ → B.", meta: ["2-5 лет", "От 100M ₽", "Результат: C₂ → C₁ → B"], color: "blue" },
            { stage: 5, title: "Промышленная добыча", desc: "Получение лицензии на добычу (до 25 лет). Строительство инфраструктуры, горнотехническая подготовка, начало промышленной эксплуатации. Окупаемость: 6-8 лет.", meta: ["Лицензия до 25 лет", "CAPEX от 1B ₽", "Выручка 50-100M+ ₽/год"], color: "emerald" },
          ].map((s, i) => (
            <div key={i} className="flex gap-5">
              <div className="flex flex-col items-center">
                <div className={`w-10 h-10 rounded-full border-2 border-${s.color}-500 bg-white flex items-center justify-center text-sm font-bold text-${s.color}-600`}>{s.stage}</div>
                {i < 4 && <div className="w-0.5 flex-1 bg-gray-200 mt-2"></div>}
              </div>
              <div className="flex-1 bg-white border border-gray-200 rounded-xl p-5 mb-1">
                <h4 className="font-semibold mb-2">{s.title}</h4>
                <p className="text-sm text-gray-500 mb-3">{s.desc}</p>
                <div className="flex flex-wrap gap-2">
                  {s.meta.map((m, j) => (
                    <span key={j} className="text-xs px-2.5 py-1 rounded-lg bg-gray-100 border border-gray-200 text-gray-600">{m}</span>
                  ))}
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>

      {/* Key Risks */}
      <div>
        <h3 className="text-xl font-bold mb-2">Ключевые риски</h3>
        <p className="text-gray-500 text-sm mb-6">Мультипликатор работает не всегда. Большинство поисковых лицензий не выживают до стадии добычи.</p>
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
          {[
            { icon: "🎰", title: "Геологический риск", desc: "Запасы могут не подтвердиться. P₁ имеет только ~15% вероятность. Из 10 проектов до C₂ доходят 2-3." },
            { icon: "📉", title: "Ценовой риск", desc: "Цены на сырьё могут упасть в течение 3-7 лет разведки, делая месторождение убыточным." },
            { icon: "⚖️", title: "Регуляторный риск", desc: "Нарушение лицензии → отзыв. Изменение законодательства, экологические ограничения, согласования." },
            { icon: "🏗", title: "Инфраструктурный риск", desc: "Удалённость от дорог, энергии, потребителей. Стоимость инфраструктуры может превысить стоимость запасов." },
            { icon: "💸", title: "Финансовый риск", desc: "Деньги кончаются до завершения разведки. Нет выручки до начала добычи — минимум 5-10 лет в убытке." },
            { icon: "🧪", title: "Технологический риск", desc: "Сложная геология, низкое содержание, сложное обогащение — проект может быть технически убыточным." },
          ].map((r, i) => (
            <div key={i} className="bg-white border border-gray-200 rounded-xl p-5">
              <div className="text-2xl mb-2">{r.icon}</div>
              <h4 className="text-sm font-semibold mb-1">{r.title}</h4>
              <p className="text-xs text-gray-500 leading-relaxed">{r.desc}</p>
            </div>
          ))}
        </div>
      </div>

      {/* Junior Model */}
      <div>
        <h3 className="text-xl font-bold mb-2">Юниорная бизнес-модель</h3>
        <p className="text-gray-500 text-sm mb-6">Классическая модель создания стоимости через геологоразведку — основа бизнеса юниорных майнеров.</p>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          {[
            { num: "1", title: "Купить дёшево", desc: "Получить поисковую лицензию (P₁/P₂) на аукционе за 100-500K ₽. Площадь ещё 'пустая' — только прогнозы.", color: "red" },
            { num: "2", title: "Вложить в ГРР", desc: "Инвестировать 20-200M ₽ в разведку: бурение, отбор проб, лабораторный анализ, документация, экспертиза ГКЗ.", color: "amber" },
            { num: "3", title: "Продать дорого", desc: "Продать ООО с лицензией и подтверждённые запасы C₂/C₁ крупной горнодобывающей компании за сотни миллионов или миллиарды ₽.", color: "emerald" },
          ].map((s, i) => (
            <div key={i} className={`bg-white border border-${s.color}-200 rounded-xl p-6`}>
              <div className={`text-4xl font-black text-${s.color}-600 mb-2`}>{s.num}</div>
              <h4 className="font-semibold mb-2">{s.title}</h4>
              <p className="text-sm text-gray-500">{s.desc}</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

// ─── Recycling Diagram Components ─────────────────────────────
const rc = {
  bg: "#f5f5f7", white: "#ffffff", card: "#ffffff", border: "#d2d2d7", borderLight: "#e8e8ed",
  text: "#1d1d1f", textSec: "#6e6e73", textTer: "#86868b",
  blue: "#0071e3", blueLight: "#e1f0ff", bluePale: "#f0f7ff",
  orange: "#e8601c", orangeLight: "#fff0e6", orangePale: "#fff8f3",
  green: "#28a745", greenLight: "#e6f9ec", greenPale: "#f3fcf5",
  red: "#d12e2e", redLight: "#fce8e8", redPale: "#fdf4f4",
  purple: "#7b61ff", purpleLight: "#eeebff", purplePale: "#f7f5ff",
};

const RHopper = ({ x, y, w, h, color, accent, hovered }) => {
  const gid = `hop-${x}-${y}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.5" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.15" />
        </linearGradient>
      </defs>
      <ellipse cx={x + w / 2} cy={y + h + 4} rx={w * 0.3} ry="4" fill="#000" opacity="0.05" />
      <path d={`M${x+4},${y+4} Q${x+4},${y} ${x+10},${y} L${x+w-10},${y} Q${x+w-4},${y} ${x+w-4},${y+4} L${x+w-4},${y+h*0.38} L${x+w*0.62},${y+h*0.82} L${x+w*0.62},${y+h} L${x+w*0.38},${y+h} L${x+w*0.38},${y+h*0.82} L${x+4},${y+h*0.38} Z`}
        fill={`url(#${gid})`} stroke={color} strokeWidth="2" strokeLinejoin="round" />
      {[0.22,0.38,0.54,0.7,0.86].map((p,i) => (
        <line key={i} x1={x+w*p-2} y1={y+h*0.08} x2={x+w*p-2} y2={y+h*0.2} stroke={color} strokeWidth="1.5" opacity="0.35" strokeLinecap="round" />
      ))}
      <ellipse cx={x+w/2} cy={y+h*0.28} rx={w*0.32} ry={h*0.06} fill={color} opacity="0.12" />
      <line x1={x+10} y1={y+3} x2={x+w*0.4} y2={y+3} stroke="#fff" strokeWidth="2" opacity="0.5" strokeLinecap="round" />
    </g>
  );
};

const RConveyor = ({ x, y, w, h, color, accent }) => {
  const gid = `conv-${x}-${y}`;
  const rr = h * 0.22;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%" stopColor={accent} stopOpacity="0.3" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.1" />
        </linearGradient>
      </defs>
      <ellipse cx={x+w/2} cy={y+h+6} rx={w*0.35} ry="4" fill="#000" opacity="0.04" />
      <line x1={x+w*0.25} y1={y+h*0.72} x2={x+w*0.2} y2={y+h} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
      <line x1={x+w*0.75} y1={y+h*0.72} x2={x+w*0.8} y2={y+h} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
      <line x1={x+w*0.5} y1={y+h*0.72} x2={x+w*0.5} y2={y+h*0.95} stroke={color} strokeWidth="2" strokeLinecap="round" />
      <rect x={x+rr+4} y={y+h*0.1} width={w-rr*2-8} height={h*0.32} rx="3" fill={`url(#${gid})`} stroke={color} strokeWidth="1.8" />
      <line x1={x+rr+6} y1={y+h*0.72} x2={x+w-rr-6} y2={y+h*0.72} stroke={color} strokeWidth="1.5" opacity="0.5" />
      <circle cx={x+rr+4} cy={y+h*0.46} r={rr} fill={rc.white} stroke={color} strokeWidth="2" />
      <circle cx={x+rr+4} cy={y+h*0.46} r={rr*0.3} fill={color} opacity="0.2" />
      <circle cx={x+w-rr-4} cy={y+h*0.46} r={rr} fill={rc.white} stroke={color} strokeWidth="2" />
      <circle cx={x+w-rr-4} cy={y+h*0.46} r={rr*0.3} fill={color} opacity="0.2" />
    </g>
  );
};

const RDrumDryer = ({ x, y, w, h, color, accent }) => {
  const gid = `drum-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.4" />
          <stop offset="50%" stopColor={accent} stopOpacity="0.15" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.35" />
        </linearGradient>
      </defs>
      <ellipse cx={x+w/2} cy={y+h+6} rx={w*0.3} ry="5" fill="#000" opacity="0.05" />
      <line x1={x+w*0.22} y1={y+h*0.88} x2={x+w*0.16} y2={y+h+2} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
      <line x1={x+w*0.78} y1={y+h*0.88} x2={x+w*0.84} y2={y+h+2} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
      <rect x={x+16} y={y+h*0.08} width={w-32} height={h*0.78} rx="4" fill={`url(#${gid})`} stroke={color} strokeWidth="2" />
      <ellipse cx={x+16} cy={y+h*0.47} rx="14" ry={h*0.39} fill={accent} stroke={color} strokeWidth="2" opacity="0.6" />
      <ellipse cx={x+w-16} cy={y+h*0.47} rx="14" ry={h*0.39} fill={accent} stroke={color} strokeWidth="2" opacity="0.6" />
      {[0.3,0.5,0.7].map((p,i) => (
        <line key={i} x1={x+w*p} y1={y+h*0.08} x2={x+w*p} y2={y+h*0.86} stroke={color} strokeWidth="1" opacity="0.2" />
      ))}
      <g opacity="0.6">
        <path d={`M${x+w+2},${y+h*0.32} q4,-8 2,-2 q6,-4 0,6 q4,-6 2,0 q4,4 -2,6 q-2,4 -4,0 q2,4 -2,4 q-4,0 -2,-4 q-4,2 -2,-2 q2,-4 0,-6 z`} fill={rc.orange} opacity="0.5" />
        <path d={`M${x+w+4},${y+h*0.5} q3,-5 1,-1 q4,-3 0,4 q3,-4 1,0 q2,3 -2,4 q-2,2 -2,0 q-2,2 -1,-1 z`} fill={rc.red} opacity="0.4" />
      </g>
      <rect x={x+20} y={y+h*0.12} width={w-40} height={h*0.12} rx="3" fill="#fff" opacity="0.25" />
    </g>
  );
};

const RCyclone = ({ x, y, w, h, color, accent }) => {
  const gid = `cyc-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.35" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.1" />
        </linearGradient>
      </defs>
      <ellipse cx={x+w/2} cy={y+h+4} rx={w*0.18} ry="3" fill="#000" opacity="0.05" />
      <rect x={x+w*0.12} y={y} width={w*0.76} height={h*0.42} rx="6" fill={`url(#${gid})`} stroke={color} strokeWidth="2" />
      <path d={`M${x+w*0.12},${y+h*0.42} L${x+w*0.43},${y+h*0.82} L${x+w*0.57},${y+h*0.82} L${x+w*0.88},${y+h*0.42}`}
        fill={`url(#${gid})`} stroke={color} strokeWidth="2" strokeLinejoin="round" />
      <rect x={x+w*0.4} y={y+h*0.82} width={w*0.2} height={h*0.18} rx="2" fill={accent} stroke={color} strokeWidth="1.8" opacity="0.7" />
      <rect x={x+w*0.88} y={y+h*0.06} width={w*0.18} height={h*0.14} rx="3" fill={accent} stroke={color} strokeWidth="1.5" opacity="0.6" />
    </g>
  );
};

const RBagFilter = ({ x, y, w, h, color, accent }) => {
  const gid = `flt-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.3" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.1" />
        </linearGradient>
      </defs>
      <ellipse cx={x+w/2} cy={y+h+4} rx={w*0.3} ry="3" fill="#000" opacity="0.04" />
      <rect x={x} y={y+8} width={w} height={h-8} rx="5" fill={`url(#${gid})`} stroke={color} strokeWidth="2" />
      <rect x={x-3} y={y} width={w+6} height={12} rx="4" fill={accent} stroke={color} strokeWidth="1.8" opacity="0.6" />
      {[0.18,0.36,0.54,0.72,0.88].map((p,i) => (
        <g key={i}>
          <line x1={x+w*p} y1={y+16} x2={x+w*p} y2={y+h-8} stroke={color} strokeWidth="1.8" opacity="0.3" strokeLinecap="round" />
          <circle cx={x+w*p} cy={y+h-8} r="2.5" fill={color} opacity="0.2" />
        </g>
      ))}
      <rect x={x+w} y={y+h*0.3} width={16} height={h*0.22} rx="3" fill={accent} stroke={color} strokeWidth="1.5" opacity="0.6" />
      <rect x={x-16} y={y+h*0.55} width={16} height={h*0.22} rx="3" fill={accent} stroke={color} strokeWidth="1.5" opacity="0.6" />
    </g>
  );
};

const RMixer = ({ x, y, w, h, color, accent }) => {
  const gid = `mix-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.35" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.1" />
        </linearGradient>
      </defs>
      <rect x={x+w/2-14} y={y-18} width={28} height={16} rx="4" fill={accent} stroke={color} strokeWidth="1.8" opacity="0.6" />
      <line x1={x+w/2} y1={y-2} x2={x+w/2} y2={y+h*0.6} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
      <path d={`M${x+4},${y+4} Q${x+4},${y} ${x+10},${y} L${x+w-10},${y} Q${x+w-4},${y} ${x+w-4},${y+4} L${x+w-4},${y+h*0.6} Q${x+w/2},${y+h+8} ${x+4},${y+h*0.6} Z`}
        fill={`url(#${gid})`} stroke={color} strokeWidth="2" strokeLinejoin="round" />
      <line x1={x+w*0.18} y1={y+h*0.42} x2={x+w*0.82} y2={y+h*0.42} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
    </g>
  );
};

const RTank = ({ x, y, w, h, color, accent }) => {
  const gid = `tnk-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.3" />
          <stop offset="60%" stopColor={accent} stopOpacity="0.15" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.35" />
        </linearGradient>
      </defs>
      <line x1={x+w*0.22} y1={y+h*0.82} x2={x+w*0.15} y2={y+h} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
      <line x1={x+w*0.78} y1={y+h*0.82} x2={x+w*0.85} y2={y+h} stroke={color} strokeWidth="2.5" strokeLinecap="round" />
      <rect x={x+6} y={y+12} width={w-12} height={h*0.7} rx="8" fill={`url(#${gid})`} stroke={color} strokeWidth="2" />
      <ellipse cx={x+w/2} cy={y+14} rx={w/2-6} ry="10" fill={accent} stroke={color} strokeWidth="1.8" opacity="0.5" />
    </g>
  );
};

const RExtruder = ({ x, y, w, h, color, accent }) => {
  const gid = `ext-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="1" y2="0">
          <stop offset="0%" stopColor={accent} stopOpacity="0.3" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.15" />
        </linearGradient>
      </defs>
      <rect x={x} y={y+h*0.18} width={w*0.72} height={h*0.52} rx="6" fill={`url(#${gid})`} stroke={color} strokeWidth="2" />
      <path d={`M${x+w*0.72},${y+h*0.1} L${x+w*0.95},${y+h*0.28} L${x+w*0.95},${y+h*0.72} L${x+w*0.72},${y+h*0.76} Z`}
        fill={accent} stroke={color} strokeWidth="2" opacity="0.5" />
      <line x1={x+w*0.2} y1={y+h*0.7} x2={x+w*0.2} y2={y+h} stroke={color} strokeWidth="2" strokeLinecap="round" />
      <line x1={x+w*0.6} y1={y+h*0.7} x2={x+w*0.6} y2={y+h} stroke={color} strokeWidth="2" strokeLinecap="round" />
    </g>
  );
};

const RTunnelOven = ({ x, y, w, h, color, accent }) => {
  const gid = `tun-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.4" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.12" />
        </linearGradient>
      </defs>
      <path d={`M${x},${y+h} L${x},${y+h*0.25} Q${x},${y} ${x+w*0.08},${y} L${x+w*0.92},${y} Q${x+w},${y} ${x+w},${y+h*0.25} L${x+w},${y+h} Z`}
        fill={`url(#${gid})`} stroke={color} strokeWidth="2" />
      <rect x={x-6} y={y+h*0.35} width={8} height={h*0.45} rx="3" fill={accent} stroke={color} strokeWidth="1.5" opacity="0.5" />
      <rect x={x+w-2} y={y+h*0.35} width={8} height={h*0.45} rx="3" fill={accent} stroke={color} strokeWidth="1.5" opacity="0.5" />
      {[0.2,0.4,0.6,0.8].map((p,i) => (
        <g key={i} opacity="0.3">
          <path d={`M${x+w*p-5},${y+14} Q${x+w*p},${y+8} ${x+w*p+5},${y+14}`} fill="none" stroke={rc.orange} strokeWidth="1.5" strokeLinecap="round" />
        </g>
      ))}
    </g>
  );
};

const RContainer = ({ x, y, w, h, color, accent }) => {
  const gid = `cnt-${x}`;
  return (
    <g>
      <defs>
        <linearGradient id={gid} x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stopColor={accent} stopOpacity="0.15" />
          <stop offset="100%" stopColor={accent} stopOpacity="0.35" />
        </linearGradient>
      </defs>
      <path d={`M${x+4},${y} L${x+w-4},${y} Q${x+w},${y} ${x+w},${y+4} L${x+w},${y+h-4} Q${x+w},${y+h} ${x+w-4},${y+h} L${x+4},${y+h} Q${x},${y+h} ${x},${y+h-4} L${x},${y+4} Q${x},${y} ${x+4},${y} Z`}
        fill={`url(#${gid})`} stroke={color} strokeWidth="2" />
      <rect x={x-3} y={y-5} width={w+6} height={8} rx="4" fill={accent} stroke={color} strokeWidth="1.5" opacity="0.5" />
      {[[0.25,0.4],[0.5,0.35],[0.75,0.45],[0.3,0.6],[0.55,0.55],[0.7,0.65]].map(([px,py],i) => (
        <circle key={i} cx={x+w*px} cy={y+h*py} r="3.5" fill={color} opacity="0.15" />
      ))}
    </g>
  );
};

const RStoneRemover = ({ x, y, w, h, color, accent }) => (
  <g>
    <rect x={x+2} y={y+4} width={w-4} height={h*0.55} rx="5"
      fill={accent} stroke={color} strokeWidth="2" opacity="0.5"
      transform={`rotate(-4,${x+w/2},${y+h*0.3})`} />
    {[0.22,0.4,0.58,0.76].map((p,i) => (
      <line key={i} x1={x+w*p} y1={y+8} x2={x+w*p} y2={y+h*0.54}
        stroke={color} strokeWidth="1" opacity="0.25" transform={`rotate(-4,${x+w/2},${y+h*0.3})`} />
    ))}
  </g>
);

const RAspiration = ({ x, y, w, h, color, accent }) => (
  <g>
    <circle cx={x+w/2} cy={y+h*0.45} r={h*0.36} fill={accent} stroke={color} strokeWidth="2" opacity="0.4" />
    <circle cx={x+w/2} cy={y+h*0.45} r={h*0.24} fill={rc.white} stroke={color} strokeWidth="1.5" opacity="0.6" />
    {[0,45,90,135,180,225,270,315].map((a,i) => (
      <line key={i} x1={x+w/2} y1={y+h*0.45}
        x2={x+w/2+Math.cos(a*Math.PI/180)*h*0.3} y2={y+h*0.45+Math.sin(a*Math.PI/180)*h*0.3}
        stroke={color} strokeWidth="1.8" opacity="0.3" strokeLinecap="round" />
    ))}
    <circle cx={x+w/2} cy={y+h*0.45} r="4" fill={color} opacity="0.3" />
  </g>
);

const reqData = [
  { id:1, name:"Приёмный бункер", sub:"влажного кека", Shape:RHopper, color:rc.blue, accent:rc.blueLight, gx:80, gy:55, sw:110, sh:85 },
  { id:2, name:"Ленточный транспортёр", sub:"", Shape:RConveyor, color:rc.blue, accent:rc.blueLight, gx:45, gy:205, sw:175, sh:58 },
  { id:3, name:"Расходный бункер", sub:"сушильной печи", Shape:RHopper, color:rc.blue, accent:rc.blueLight, gx:295, gy:185, sw:85, sh:75 },
  { id:4, name:"Аспирация", sub:"", Shape:RAspiration, color:rc.purple, accent:rc.purpleLight, gx:535, gy:40, sw:95, sh:75 },
  { id:5, name:"Барабанная сушильная печь", sub:"предварительной сушки", Shape:RDrumDryer, color:rc.orange, accent:rc.orangeLight, gx:410, gy:182, sw:185, sh:78 },
  { id:6, name:"Камнеудалитель", sub:"", Shape:RStoneRemover, color:rc.green, accent:rc.greenLight, gx:440, gy:335, sw:120, sh:70 },
  { id:7, name:"Смеситель", sub:"", Shape:RMixer, color:rc.green, accent:rc.greenLight, gx:275, gy:460, sw:95, sh:92 },
  { id:8, name:"Узел приготовления", sub:"раствора ЛСТ", Shape:RTank, color:rc.purple, accent:rc.purpleLight, gx:80, gy:460, sw:90, sh:88 },
  { id:9, name:"Пресс-гранулятор", sub:"шнековый", Shape:RExtruder, color:rc.orange, accent:rc.orangeLight, gx:240, gy:630, sw:160, sh:72 },
  { id:10, name:"Тоннельная печь", sub:"контрольной сушки", Shape:RTunnelOven, color:rc.orange, accent:rc.orangeLight, gx:240, gy:775, sw:165, sh:65 },
  { id:11, name:"Групповой циклон", sub:"грубой очистки газа", Shape:RCyclone, color:rc.red, accent:rc.redLight, gx:680, gy:180, sw:100, sh:108 },
  { id:12, name:"Рукавный фильтр", sub:"тонкой очистки газа", Shape:RBagFilter, color:rc.red, accent:rc.redLight, gx:685, gy:390, sw:95, sh:90 },
  { id:13, name:"Контейнер", sub:"готовых пеллет", Shape:RContainer, color:rc.green, accent:rc.greenLight, gx:275, gy:910, sw:110, sh:75 },
];

const RFA = ({ path, color = rc.textTer, dash = false }) => (
  <path d={path} fill="none" stroke={color} strokeWidth="1.8" strokeDasharray={dash?"7,5":"none"} opacity="0.45"
    markerEnd={`url(#rarw-${color.replace("#","")})`} />
);

const RecyclingEquipmentDiagram = ({ hovered, setHovered }) => (
  <svg viewBox="0 0 860 1060" style={{ width:"100%", minWidth:500, height:"auto" }}>
    <defs>
      {[rc.blue,rc.orange,rc.green,rc.red,rc.purple,rc.textTer].map(col => (
        <marker key={col} id={`rarw-${col.replace("#","")}`} viewBox="0 0 12 8" refX="11" refY="4"
          markerWidth="8" markerHeight="6" orient="auto-start-reverse">
          <polygon points="0 0, 12 4, 0 8" fill={col} opacity="0.6" />
        </marker>
      ))}
      <filter id="reqSh"><feDropShadow dx="0" dy="2" stdDeviation="4" floodColor="#000" floodOpacity="0.06" /></filter>
    </defs>
    <rect x={30} y={30} width={260} height={310} rx="20" fill={rc.bluePale} opacity="0.5" />
    <rect x={660} y={160} width={150} height={340} rx="20" fill={rc.redPale} opacity="0.5" />
    <rect x={220} y={580} width={210} height={300} rx="20" fill={rc.orangePale} opacity="0.5" />
    <text x={160} y={48} fill={rc.blue} fontSize="10" fontWeight="600" textAnchor="middle" opacity="0.5" letterSpacing="1.5">ПОДАЧА</text>
    <text x={735} y={178} fill={rc.red} fontSize="10" fontWeight="600" textAnchor="middle" opacity="0.5" letterSpacing="1.5">ГАЗООЧИСТКА</text>
    <text x={325} y={618} fill={rc.orange} fontSize="10" fontWeight="600" textAnchor="middle" opacity="0.5" letterSpacing="1.5">ГРАНУЛИРОВАНИЕ И СУШКА</text>
    <RFA path="M135,140 L135,205" color={rc.blue} />
    <RFA path="M220,234 L295,220" color={rc.blue} />
    <RFA path="M380,220 L410,220" color={rc.blue} />
    <RFA path="M545,182 L570,125 L570,115" color={rc.purple} dash />
    <RFA path="M595,220 L680,220" color={rc.red} dash />
    <RFA path="M505,260 L500,335" color={rc.orange} />
    <RFA path="M440,390 L375,460" color={rc.green} />
    <RFA path="M170,504 L275,504" color={rc.purple} />
    <RFA path="M322,552 L322,630" color={rc.green} />
    <RFA path="M322,702 L322,775" color={rc.orange} />
    <RFA path="M322,840 L325,910" color={rc.green} />
    <RFA path="M735,288 L735,390" color={rc.red} />
    <RFA path="M735,480 L735,530" color={rc.green} />
    {reqData.map(eq => {
      const isH = hovered === eq.id;
      return (
        <g key={eq.id} onMouseEnter={() => setHovered(eq.id)} onMouseLeave={() => setHovered(null)}
          style={{ cursor:"pointer" }} filter={isH?"url(#reqSh)":undefined} opacity={hovered && !isH ? 0.45 : 1}>
          <eq.Shape x={eq.gx} y={eq.gy} w={eq.sw} h={eq.sh} color={eq.color} accent={isH?eq.accent:rc.white} hovered={isH} />
          <circle cx={eq.gx+eq.sw-4} cy={eq.gy+eq.sh-4} r="12" fill={eq.color} opacity={isH?1:0.82} />
          <text x={eq.gx+eq.sw-4} y={eq.gy+eq.sh} fill="#fff" fontSize="10.5" fontWeight="700" textAnchor="middle">{eq.id}</text>
          <text x={eq.gx+eq.sw/2} y={eq.gy+eq.sh+20} fill={isH?eq.color:rc.textSec} fontSize="10.5" fontWeight="600" textAnchor="middle">{eq.name}</text>
          {eq.sub && <text x={eq.gx+eq.sw/2} y={eq.gy+eq.sh+33} fill={rc.textTer} fontSize="9.5" textAnchor="middle">{eq.sub}</text>}
        </g>
      );
    })}
    <rect x={688} y={532} width={94} height={28} rx="14" fill={rc.greenLight} stroke={rc.green} strokeWidth="1.2" />
    <text x={735} y={550} fill={rc.green} fontSize="10.5" fontWeight="600" textAnchor="middle">→ в атмосферу</text>
    <rect x={280} y={1005} width={100} height={28} rx="14" fill={rc.greenLight} stroke={rc.green} strokeWidth="1.2" />
    <text x={330} y={1023} fill={rc.green} fontSize="10.5" fontWeight="600" textAnchor="middle">→ отгрузка</text>
    <RFA path="M330,985 L330,1005" color={rc.green} />
  </svg>
);

// ─── Recycling Section ────────────────────────────────────────
function RecyclingSection() {
  const [hovered, setHovered] = useState(null);
  return (
    <div className="space-y-10">
      {/* Intro */}
      <div className="bg-gradient-to-br from-green-50 to-white border border-green-200 rounded-2xl p-8">
        <div className="text-xs font-semibold tracking-widest text-green-600 uppercase mb-3">Токены переработки отходов</div>
        <h3 className="text-2xl font-bold text-gray-900 mb-3">Производство пеллет из промышленных отходов</h3>
        <p className="text-gray-500 leading-relaxed max-w-3xl">
          Промышленные шламы и технологические отходы могут быть трансформированы в ценные строительные пеллеты через сложную цепочку обработки. Эта технология преобразует затраты на утилизацию отходов в доходные продукты, создавая одновременно экологическую и экономическую ценность.
        </p>
      </div>

      {/* Interactive Equipment Diagram */}
      <div>
        <h3 className="text-xl font-bold text-gray-900 mb-2">Схема оборудования</h3>
        <p className="text-gray-500 text-sm mb-4">Интерактивная диаграмма полной линии производства пеллет. Наведите на оборудование, чтобы выделить его.</p>
        <div className="bg-white border border-gray-200 rounded-2xl p-4 overflow-x-auto" style={{ boxShadow: "0 4px 24px rgba(0,0,0,0.06)" }}>
          <RecyclingEquipmentDiagram hovered={hovered} setHovered={setHovered} />
        </div>
        <div className="flex justify-center flex-wrap gap-4 mt-4 text-xs font-medium">
          {[{color:"#0071e3",label:"Подача и транспорт"},{color:"#e8601c",label:"Сушка и гранулирование"},{color:"#28a745",label:"Обработка и выход"},{color:"#d12e2e",label:"Газоочистка"},{color:"#7b61ff",label:"Вспомогательное"}].map(l => (
            <div key={l.label} className="flex items-center gap-2">
              <div className="w-2.5 h-2.5 rounded-full" style={{background:l.color}}></div>
              <span className="text-gray-500">{l.label}</span>
            </div>
          ))}
        </div>
      </div>

      {/* Equipment Table */}
      <div>
        <h3 className="text-xl font-bold text-gray-900 mb-2">Перечень оборудования</h3>
        <div className="bg-white border border-gray-200 rounded-xl overflow-hidden" style={{ boxShadow: "0 2px 12px rgba(0,0,0,0.05)" }}>
          <table style={{ width:"100%", borderCollapse:"collapse", fontSize:13 }}>
            <tbody>
              {reqData.map(eq => (
                <tr key={eq.id} onMouseEnter={() => setHovered(eq.id)} onMouseLeave={() => setHovered(null)}
                  style={{ background: hovered===eq.id ? eq.accent : "transparent", transition:"background 0.15s", cursor:"pointer", borderBottom:"1px solid #e8e8ed" }}>
                  <td style={{ padding:"10px 16px", width:48 }}>
                    <span style={{ display:"inline-flex", alignItems:"center", justifyContent:"center",
                      width:26, height:26, borderRadius:"50%", background:eq.color, color:"#fff", fontSize:11, fontWeight:700 }}>{eq.id}</span>
                  </td>
                  <td style={{ padding:"10px 16px", color: hovered===eq.id ? eq.color : "#1d1d1f", fontWeight:500, transition:"color 0.15s" }}>
                    {eq.name}{eq.sub ? ` — ${eq.sub}` : ""}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      {/* Investment Opportunity */}
      <div className="bg-gradient-to-br from-emerald-50 to-white border border-emerald-200 rounded-2xl p-8">
        <h3 className="text-xl font-bold text-gray-900 mb-3">Инвестиционная возможность</h3>
        <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4">
          <div className="text-center">
            <div className="text-2xl font-bold text-emerald-600">ESG+</div>
            <div className="text-xs text-gray-500 mt-1">Соответствие экологическим требованиям</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-amber-600">24/7</div>
            <div className="text-xs text-gray-500 mt-1">Непрерывное производство</div>
          </div>
          <div className="text-center">
            <div className="text-2xl font-bold text-blue-600">Выручка</div>
            <div className="text-xs text-gray-500 mt-1">Из отходных материалов</div>
          </div>
        </div>
        <p className="text-sm text-gray-500">Токены переработки отходов предоставляют доступ к растущему сектору промышленного управления отходами. Технология преобразует экологические обязательства в ценные строительные материалы, пользующиеся высоким спросом на инфраструктурные проекты.</p>
      </div>
    </div>
  );
}

// ─── Pre-IPO Section ──────────────────────────────────────────
function PreIPOSection() {
  return (
    <div className="space-y-10">
      {/* Intro */}
      <div className="bg-gradient-to-br from-indigo-50 to-white border border-indigo-200 rounded-2xl p-8">
        <div className="text-xs font-semibold tracking-widest text-indigo-600 uppercase mb-3">Инвестиции в Pre-IPO</div>
        <h3 className="text-2xl font-bold mb-3">Инвестируйте в частные компании до их выхода на биржу</h3>
        <p className="text-gray-500 leading-relaxed max-w-3xl">
          Pre-IPO означает покупку акций или фьючерсов частных компаний на стадии, предшествующей их первичному публичному предложению. Традиционно это было доступно только крупным инвесторам с минимумом $10M+, но современные платформы открыли доступ розничным инвесторам с намного более низкими порогами.
        </p>
      </div>

      {/* How It Works Steps */}
      <div>
        <h3 className="text-xl font-bold mb-2">Как работают Pre-IPO инвестиции</h3>
        <p className="text-gray-500 text-sm mb-6">Путь от выбора частной компании к получению доходов после IPO.</p>
        <div className="space-y-4">
          {[
            { step: 1, title: "Выбор компании и проверка", desc: "Платформы тщательно отбирают компании с высоким ростом, которые, как ожидается, выйдут на IPO в течение 1-3 лет. Анализ охватывает динамику выручки, раунды финансирования, позицию на рынке и траекторию роста. Проходят только самые привлекательные компании.", color: "indigo" },
            { step: 2, title: "Приобретение акций", desc: "Акции покупаются на приватном вторичном рынке — у ранних сотрудников, бизнес-ангелов или венчурных фондов, ищущих выхода. Некоторые платформы используют структуры SPV (Специальная цель компании) для объединения капитала инвесторов и приобретения более крупных блоков.", color: "blue" },
            { step: 3, title: "Ценообразование и торговля", desc: "Маркет-мейкеры устанавливают начальные цены на основе последних приватных рыночных сделок и фундаментальных показателей компании. Инвесторы могут свободно покупать и продавать на платформе, фиксируя прибыль или усредняя позицию в любое время.", color: "violet" },
            { step: 4, title: "Событие IPO", desc: "Когда компания выходит на биржу, начинается отсчет до истечения фьючерсов (обычно ~200 дней). В этот период акции продаются на публичной бирже по рыночной цене, и выручка распределяется между держателями токенов/фьючерсов.", color: "emerald" },
            { step: 5, title: "Расчет и доходы", desc: "После периода блокировки (обычно 6 месяцев после IPO) акции могут свободно торговаться. Прибыль рассчитывается на основе разницы между ценой покупки и публичной рыночной ценой при расчете.", color: "amber" },
          ].map((s, i) => (
            <div key={i} className="flex gap-5">
              <div className="flex flex-col items-center">
                <div className={`w-10 h-10 rounded-full border-2 border-${s.color}-500 bg-white flex items-center justify-center text-sm font-bold text-${s.color}-600`}>{s.step}</div>
                {i < 4 && <div className="w-0.5 flex-1 bg-gray-200 mt-2"></div>}
              </div>
              <div className="flex-1 bg-white border border-gray-200 rounded-xl p-5 mb-1">
                <h4 className="font-semibold mb-2">{s.title}</h4>
                <p className="text-sm text-gray-500">{s.desc}</p>
              </div>
            </div>
          ))}
        </div>
      </div>

      {/* Advantages */}
      <div>
        <h3 className="text-xl font-bold mb-2">Ключевые преимущества</h3>
        <p className="text-gray-500 text-sm mb-6">Почему инвесторы привлечены возможностями Pre-IPO.</p>
        <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
          {[
            { icon: "🔓", title: "Доступ к приватным рынкам", desc: "Инвестируйте в компании, такие как Anthropic, SpaceX и Stripe, до их появления на публичных биржах." },
            { icon: "💰", title: "Более низкие комиссии", desc: "В отличие от специализированных PE-фондов, которые взимают управленческие сборы + сборы за успех, вы платите только комиссии за транзакцию." },
            { icon: "🎯", title: "Кураторский отбор", desc: "Платформы тщательно проверяют компании, отбирая только самых перспективных кандидатов с сильным потенциалом IPO." },
            { icon: "🔄", title: "Гибкий выход", desc: "В отличие от традиционных PE блокировок, фьючерсы/токены Pre-IPO можно свободно торговать — не нужно ждать IPO." },
            { icon: "📊", title: "100% распределение", desc: "В отличие от публичных IPO, где распределение может быть всего 7%, заказы Pre-IPO обычно выполняются полностью." },
            { icon: "🌍", title: "Глобальный доступ", desc: "Инвестируйте откуда угодно с минимальными требованиями KYC. Пополняйте счета фиатом или криптовалютой." },
          ].map((a, i) => (
            <div key={i} className="bg-white border border-gray-200 rounded-xl p-5 hover:-translate-y-0.5 transition">
              <div className="text-2xl mb-2">{a.icon}</div>
              <h4 className="text-sm font-semibold mb-1">{a.title}</h4>
              <p className="text-xs text-gray-500 leading-relaxed">{a.desc}</p>
            </div>
          ))}
        </div>
      </div>

      {/* Exit Scenarios */}
      <div>
        <h3 className="text-xl font-bold mb-2">Сценарии выхода</h3>
        <p className="text-gray-500 text-sm mb-6">Что происходит с вашей инвестицией после изменения статуса компании.</p>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          {[
            { title: "IPO", desc: "Компания выходит на биржу. После периода блокировки ~6 месяцев акции продаются по рыночной цене и прибыль распределяется. Наиболее распространённый и обычно самый прибыльный выход.", color: "emerald", icon: "🚀" },
            { title: "M&A (Приобретение)", desc: "Компания приобретается более крупной организацией. Доходы зависят от условий сделки и раунда, на котором вошли инвесторы. Может быть положительным, если приобретено с премией.", color: "blue", icon: "🤝" },
            { title: "Вторичная/OTC продажа", desc: "Если IPO задержано или отменено, акции могут быть проданы на OTC-рынках. Может привести к более низким доходам или частичным потерям с ~15% затратами на транзакцию для раннего выхода.", color: "amber", icon: "🔄" },
          ].map((e, i) => (
            <div key={i} className={`bg-${e.color}-50 border border-${e.color}-200 rounded-xl p-6`}>
              <div className="text-3xl mb-3">{e.icon}</div>
              <h4 className="font-semibold mb-2">{e.title}</h4>
              <p className="text-sm text-gray-500">{e.desc}</p>
            </div>
          ))}
        </div>
      </div>

      {/* Risks */}
      <div>
        <h3 className="text-xl font-bold mb-2">Риски для рассмотрения</h3>
        <p className="text-gray-500 text-sm mb-6">Pre-IPO инвестирование несёт присущие ему риски. Понимание их критически важно перед инвестированием.</p>
        <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
          {[
            { icon: "⏰", title: "Неопределённые сроки", desc: "Компании могут отложить IPO на годы. Нет гарантированной даты листинга, и некоторые могут никогда не выйти на биржу." },
            { icon: "💧", title: "Низкая ликвидность", desc: "Ранний выход может занять больше месяца. Приватные рынки внутренне менее ликвидны, чем публичные биржи." },
            { icon: "📋", title: "Асимметрия информации", desc: "Менеджмент и ранние инвесторы имеют больше информации, чем розничные инвесторы. Финансовые раскрытия ограничены." },
            { icon: "⚠️", title: "Возможна полная потеря", desc: "Pre-IPO по своей природе рискованно. Компании могут потерпеть неудачу, и инвесторы могут потерять всю инвестицию." },
          ].map((r, i) => (
            <div key={i} className="bg-red-50 border border-red-200 rounded-xl p-5">
              <div className="text-2xl mb-2">{r.icon}</div>
              <h4 className="text-sm font-semibold mb-1">{r.title}</h4>
              <p className="text-xs text-gray-500 leading-relaxed">{r.desc}</p>
            </div>
          ))}
        </div>
      </div>

      {/* Disclaimer */}
      <div className="bg-amber-50 border border-amber-200 rounded-xl p-5 text-center">
        <p className="text-xs text-amber-700"><strong>Дисклеймер:</strong> Pre-IPO инвестиции несут значительный риск. Это содержание предназначено только в образовательных целях. Прошлые результаты не гарантируют будущие результаты. Всегда консультируйтесь с квалифицированным финансовым консультантом перед инвестированием.</p>
      </div>
    </div>
  );
}

// ─── Main App (Open Access) ──────────────────────────────────
function InvestmentApp() {
  const [user, setUser] = useState(null);
  const [authModal, setAuthModal] = useState(null); // null | "login" | "register"
  const [currentPage, setCurrentPage] = useState("dashboard");

  const handleAuthSwitch = (action) => {
    if (action === "switch-register") setAuthModal("register");
    else if (action === "switch-login") setAuthModal("login");
  };

  return (
    <>
      {currentPage === "dashboard" ? (
        <Dashboard
          user={user}
          onLogout={() => setUser(null)}
          onOpenAuth={(mode) => setAuthModal(mode)}
          onNavigate={setCurrentPage}
        />
      ) : currentPage === "howitworks" ? (
        <HowItWorksPage onNavigate={setCurrentPage} />
      ) : (
        <Dashboard
          user={user}
          onLogout={() => setUser(null)}
          onOpenAuth={(mode) => setAuthModal(mode)}
          onNavigate={setCurrentPage}
        />
      )}
      {authModal && (
        <AuthModal
          mode={authModal}
          onClose={() => setAuthModal(null)}
          onLogin={(u) => setUser(u)}
          onComplete={handleAuthSwitch}
        />
      )}
    </>
  );
}


        // Mount the React app
        try {
          ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(InvestmentApp));
        } catch(e) {
          document.getElementById("root").innerHTML = '<div style="color:red;padding:40px;font-size:18px;background:white;"><h2>Error:</h2><pre>' + e.message + '\n\n' + e.stack + '</pre></div>';
        }
    </script>
</body>
</html>
